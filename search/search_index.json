{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"TossPayments Python Server SDK","text":"<p>\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc11c\ubc84 API\ub97c \uc27d\uac8c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 Python \ud074\ub77c\uc774\uc5b8\ud2b8 \ub77c\uc774\ube0c\ub7ec\ub9ac\uc785\ub2c8\ub2e4.</p>"},{"location":"#_1","title":"\uc8fc\uc694 \uae30\ub2a5","text":"<p>\u2705 \uac04\ud3b8\ud55c \uacb0\uc81c \ucc98\ub9ac - \uacb0\uc81c \uc2b9\uc778, \uc870\ud68c, \ucde8\uc18c\ub97c \uac04\ub2e8\ud55c \uba54\uc11c\ub4dc\ub85c \u2705 \uc6f9\ud6c5 \uc9c0\uc6d0 - \uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd, \uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ucf5c\ubc31 \ub4f1 \uc6f9\ud6c5 \uc790\ub3d9 \ud30c\uc2f1 \u2705 \ud0c0\uc785 \uc548\uc804\uc131 - dataclass\uc640 enum\uc744 \ud65c\uc6a9\ud55c \ud0c0\uc785 \ud78c\ud305 \u2705 \uc5d0\ub7ec \ucc98\ub9ac - \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 API \uc5d0\ub7ec\ub97c Python \uc608\uc678\ub85c \uc790\ub3d9 \ubcc0\ud658 \u2705 \ube44\ub3d9\uae30 \uc9c0\uc6d0 - requests \uae30\ubc18\uc758 \uc548\uc815\uc801\uc778 HTTP \ud074\ub77c\uc774\uc5b8\ud2b8  </p>"},{"location":"#_2","title":"\ube60\ub978 \uc2dc\uc791","text":""},{"location":"#_3","title":"\uc124\uce58","text":"<pre><code>pip install tosspayments-python-server-sdk\n</code></pre>"},{"location":"#_4","title":"\uae30\ubcf8 \uc0ac\uc6a9\ubc95","text":"<pre><code>from tosspayments_server_sdk import Client\n\n# \ud074\ub77c\uc774\uc5b8\ud2b8 \ucd08\uae30\ud654\nclient = Client(secret_key=\"test_sk_...\")\n\n# \uacb0\uc81c \uc2b9\uc778\npayment = client.payments.confirm(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    order_id=\"order-123\",\n    amount=15000\n)\n\nprint(f\"\uacb0\uc81c \uc0c1\ud0dc: {payment.status}\")\nprint(f\"\uacb0\uc81c \ubc29\ubc95: {payment.method}\")\n</code></pre>"},{"location":"#_5","title":"\uc6f9\ud6c5 \ucc98\ub9ac","text":"<pre><code># \uc6f9\ud6c5 \ub370\uc774\ud130 \ud30c\uc2f1\nwebhook_event = client.webhooks.verify_and_parse(request_body)\n\nif webhook_event.is_payment_event:\n    payment = webhook_event.payment\n    if payment.is_paid():\n        print(f\"\uacb0\uc81c \uc644\ub8cc: {payment.order_id}\")\n</code></pre>"},{"location":"#_6","title":"\ub2e4\uc74c \ub2e8\uacc4","text":"<ul> <li>\uc124\uce58 \uac00\uc774\ub4dc\uc5d0\uc11c \uc790\uc138\ud55c \uc124\uce58 \ubc29\ubc95 \ud655\uc778</li> <li>\ube60\ub978 \uc2dc\uc791\uc5d0\uc11c \uae30\ubcf8 \uc0ac\uc6a9\ubc95 \ud559\uc2b5</li> <li>API \uac00\uc774\ub4dc\uc5d0\uc11c \uacb0\uc81c API \uc0c1\uc138 \uc0ac\uc6a9\ubc95 \ud655\uc778</li> <li>\uc608\uc81c\uc5d0\uc11c \uc2e4\uc81c \uc0ac\uc6a9 \uc0ac\ub840 \ucc38\uace0</li> </ul>"},{"location":"#_7","title":"\uc9c0\uc6d0\ud558\ub294 \uae30\ub2a5","text":"\uae30\ub2a5 \uc0c1\ud0dc \uacb0\uc81c \uc2b9\uc778 \u2705 \uacb0\uc81c \uc870\ud68c \u2705 \uacb0\uc81c \ucde8\uc18c \u2705 \uc6f9\ud6c5 \ucc98\ub9ac \u2705 \uac00\uc0c1\uacc4\uc88c \u2705 \uce74\ub4dc \uacb0\uc81c \u2705 \uac04\ud3b8\uacb0\uc81c \u2705"},{"location":"#_8","title":"\ub77c\uc774\uc13c\uc2a4","text":"<p>MIT License</p>"},{"location":"api/error-handling/","title":"\uc5d0\ub7ec \ucc98\ub9ac","text":"<p>TossPayments SDK\uc5d0\uc11c \ubc1c\uc0dd\ud560 \uc218 \uc788\ub294 \ub2e4\uc591\ud55c \uc5d0\ub7ec\ub97c \ucc98\ub9ac\ud558\ub294 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4.</p>"},{"location":"api/error-handling/#_2","title":"\uc5d0\ub7ec \uc885\ub958","text":"<p>SDK\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uc608\uc678 \ud074\ub798\uc2a4\ub4e4\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4:</p>"},{"location":"api/error-handling/#_3","title":"\uae30\ubcf8 \uc608\uc678 \uacc4\uce35","text":"<pre><code>TossPaymentsError (\uae30\ubcf8 \uc608\uc678)\n\u251c\u2500\u2500 APIError (API \ud638\ucd9c \uad00\ub828)\n\u2502   \u251c\u2500\u2500 AuthenticationError (\uc778\uc99d \uc624\ub958)\n\u2502   \u251c\u2500\u2500 RateLimitError (\uc694\uccad \ud55c\ub3c4 \ucd08\uacfc)\n\u2502   \u2514\u2500\u2500 PaymentNotFoundError (\uacb0\uc81c \uc815\ubcf4 \uc5c6\uc74c)\n\u251c\u2500\u2500 ValidationError (\uc785\ub825\uac12 \uac80\uc99d \uc624\ub958)\n\u251c\u2500\u2500 WebhookVerificationError (\uc6f9\ud6c5 \uac80\uc99d \uc624\ub958)\n\u2514\u2500\u2500 NetworkError (\ub124\ud2b8\uc6cc\ud06c \uc624\ub958)\n</code></pre>"},{"location":"api/error-handling/#_4","title":"\uc608\uc678 \ud074\ub798\uc2a4\ubcc4 \uc0c1\uc138","text":""},{"location":"api/error-handling/#1-apierror-api","title":"1. APIError - API \ud638\ucd9c \uc624\ub958","text":"<p>\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 API \ud638\ucd9c \uc2dc \ubc1c\uc0dd\ud558\ub294 \ubaa8\ub4e0 \uc624\ub958\uc758 \uae30\ubcf8 \ud074\ub798\uc2a4\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import APIError\n\ntry:\n    payment = client.payments.confirm(\n        payment_key=\"invalid_key\",\n        order_id=\"order-123\", \n        amount=15000\n    )\nexcept APIError as e:\n    print(f\"API \uc5d0\ub7ec: {e.message}\")\n    print(f\"\uc5d0\ub7ec \ucf54\ub4dc: {e.error_code}\")\n    print(f\"HTTP \uc0c1\ud0dc\ucf54\ub4dc: {e.status_code}\")\n    print(f\"\uc751\ub2f5 \ub370\uc774\ud130: {e.response_data}\")\n</code></pre> <p>\uc8fc\uc694 \uc18d\uc131: - <code>message</code>: \uc5d0\ub7ec \uba54\uc2dc\uc9c0 - <code>error_code</code>: \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc5d0\ub7ec \ucf54\ub4dc - <code>status_code</code>: HTTP \uc0c1\ud0dc \ucf54\ub4dc - <code>response_data</code>: API \uc751\ub2f5 \uc804\uccb4 \ub370\uc774\ud130</p>"},{"location":"api/error-handling/#2-authenticationerror-","title":"2. AuthenticationError - \uc778\uc99d \uc624\ub958","text":"<p>API \ud0a4\uac00 \uc798\ubabb\ub418\uc5c8\uac70\ub098 \uc778\uc99d\uc5d0 \uc2e4\ud328\ud55c \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import AuthenticationError\n\ntry:\n    client = Client(secret_key=\"wrong_key\")\n    payment = client.payments.retrieve(\"payment_key\")\nexcept AuthenticationError as e:\n    print(f\"\uc778\uc99d \uc2e4\ud328: {e}\")\n    # API \ud0a4 \ud655\uc778 \ud544\uc694\n</code></pre> <p>\uc77c\ubc18\uc801\uc778 \uc6d0\uc778: - \uc798\ubabb\ub41c API \ud0a4 \ud615\uc2dd - \ub9cc\ub8cc\ub41c API \ud0a4 - \uad8c\ud55c\uc774 \uc5c6\ub294 API \ud0a4</p>"},{"location":"api/error-handling/#3-validationerror-","title":"3. ValidationError - \uc785\ub825\uac12 \uac80\uc99d \uc624\ub958","text":"<p>SDK\uc5d0 \uc804\ub2ec\ub41c \ub9e4\uac1c\ubcc0\uc218\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import ValidationError\n\ntry:\n    # \uc798\ubabb\ub41c \uc785\ub825\uac12\n    payment = client.payments.confirm(\n        payment_key=\"\",  # \ube48 \ubb38\uc790\uc5f4\n        order_id=\"order-123\",\n        amount=-1000  # \uc74c\uc218 \uae08\uc561\n    )\nexcept ValidationError as e:\n    print(f\"\uc785\ub825\uac12 \uc624\ub958: {e}\")\n</code></pre> <p>\uc77c\ubc18\uc801\uc778 \uc6d0\uc778: - \ud544\uc218 \ub9e4\uac1c\ubcc0\uc218 \ub204\ub77d - \uc798\ubabb\ub41c \ub370\uc774\ud130 \ud0c0\uc785 - \ubc94\uc704\ub97c \ubc97\uc5b4\ub09c \uac12</p>"},{"location":"api/error-handling/#4-paymentnotfounderror-","title":"4. PaymentNotFoundError - \uacb0\uc81c \uc815\ubcf4 \uc5c6\uc74c","text":"<p>\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \uacb0\uc81c\ub97c \uc870\ud68c\ud558\ub824 \ud560 \ub54c \ubc1c\uc0dd\ud569\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import PaymentNotFoundError\n\ntry:\n    payment = client.payments.retrieve(\"non_existent_payment_key\")\nexcept PaymentNotFoundError as e:\n    print(f\"\uacb0\uc81c \uc815\ubcf4 \uc5c6\uc74c: {e}\")\n    # \uc8fc\ubb38 ID\ub098 \uacb0\uc81c \ud0a4 \ud655\uc778 \ud544\uc694\n</code></pre>"},{"location":"api/error-handling/#5-ratelimiterror-","title":"5. RateLimitError - \uc694\uccad \ud55c\ub3c4 \ucd08\uacfc","text":"<p>API \ud638\ucd9c \ud69f\uc218\uac00 \uc81c\ud55c\uc744 \ucd08\uacfc\ud55c \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import RateLimitError\nimport time\n\ntry:\n    payment = client.payments.retrieve(\"payment_key\")\nexcept RateLimitError as e:\n    print(f\"\uc694\uccad \ud55c\ub3c4 \ucd08\uacfc: {e}\")\n    # \uc7a0\uc2dc \ub300\uae30 \ud6c4 \uc7ac\uc2dc\ub3c4\n    time.sleep(5)\n    payment = client.payments.retrieve(\"payment_key\")\n</code></pre>"},{"location":"api/error-handling/#6-networkerror-","title":"6. NetworkError - \ub124\ud2b8\uc6cc\ud06c \uc624\ub958","text":"<p>\uc778\ud130\ub137 \uc5f0\uacb0 \ubb38\uc81c\ub098 \uc11c\ubc84 \uc751\ub2f5 \uc5c6\uc74c \ub4f1\uc758 \ub124\ud2b8\uc6cc\ud06c \uad00\ub828 \uc624\ub958\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import NetworkError\n\ntry:\n    payment = client.payments.retrieve(\"payment_key\")\nexcept NetworkError as e:\n    print(f\"\ub124\ud2b8\uc6cc\ud06c \uc624\ub958: {e}\")\n    # \ub124\ud2b8\uc6cc\ud06c \uc0c1\ud0dc \ud655\uc778 \ub610\ub294 \uc7ac\uc2dc\ub3c4\n</code></pre>"},{"location":"api/error-handling/#7-webhookverificationerror-","title":"7. WebhookVerificationError - \uc6f9\ud6c5 \uac80\uc99d \uc624\ub958","text":"<p>\uc6f9\ud6c5 \ub370\uc774\ud130 \ud30c\uc2f1\uc5d0 \uc2e4\ud328\ud55c \uacbd\uc6b0\uc785\ub2c8\ub2e4.</p> <pre><code>from tosspayments_server_sdk.exceptions import WebhookVerificationError\n\ntry:\n    webhook_event = client.webhooks.verify_and_parse(invalid_data)\nexcept WebhookVerificationError as e:\n    print(f\"\uc6f9\ud6c5 \uac80\uc99d \uc2e4\ud328: {e}\")\n    # \uc6f9\ud6c5 \ub370\uc774\ud130 \ud615\uc2dd \ud655\uc778\n</code></pre>"},{"location":"api/error-handling/#_5","title":"\uc5d0\ub7ec \ucc98\ub9ac \ud328\ud134","text":""},{"location":"api/error-handling/#1","title":"1. \uae30\ubcf8 \uc5d0\ub7ec \ucc98\ub9ac","text":"<pre><code>from tosspayments_server_sdk.exceptions import TossPaymentsError\n\ndef safe_payment_confirm(payment_key, order_id, amount):\n    try:\n        payment = client.payments.confirm(\n            payment_key=payment_key,\n            order_id=order_id,\n            amount=amount\n        )\n        return {\"success\": True, \"payment\": payment}\n\n    except TossPaymentsError as e:\n        return {\"success\": False, \"error\": str(e)}\n    except Exception as e:\n        # \uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958\n        logger.error(f\"\uc608\uc0c1\uce58 \ubabb\ud55c \uc624\ub958: {e}\", exc_info=True)\n        return {\"success\": False, \"error\": \"\uc2dc\uc2a4\ud15c \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4\"}\n</code></pre>"},{"location":"api/error-handling/#2","title":"2. \uad6c\uccb4\uc801\uc778 \uc5d0\ub7ec\ubcc4 \ucc98\ub9ac","text":"<pre><code>def process_payment(payment_key, order_id, amount):\n    try:\n        payment = client.payments.confirm(\n            payment_key=payment_key,\n            order_id=order_id, \n            amount=amount\n        )\n        return handle_successful_payment(payment)\n\n    except ValidationError as e:\n        # \uc785\ub825\uac12 \uc624\ub958 - \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \uc0c1\uc138 \uc815\ubcf4 \uc81c\uacf5\n        return {\n            \"success\": False,\n            \"error_type\": \"validation_error\",\n            \"message\": f\"\uc785\ub825\uac12 \uc624\ub958: {e}\",\n            \"retry_possible\": False\n        }\n\n    except AuthenticationError as e:\n        # \uc778\uc99d \uc624\ub958 - \uc2dc\uc2a4\ud15c \uad00\ub9ac\uc790\uc5d0\uac8c \uc54c\ub9bc\n        logger.critical(f\"API \uc778\uc99d \uc2e4\ud328: {e}\")\n        send_admin_alert(\"API \ud0a4 \ud655\uc778 \ud544\uc694\")\n        return {\n            \"success\": False,\n            \"error_type\": \"auth_error\", \n            \"message\": \"\uc2dc\uc2a4\ud15c \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4\",\n            \"retry_possible\": False\n        }\n\n    except PaymentNotFoundError as e:\n        # \uacb0\uc81c \uc815\ubcf4 \uc5c6\uc74c - \uc8fc\ubb38 \uc0c1\ud0dc \ud655\uc778\n        return {\n            \"success\": False,\n            \"error_type\": \"payment_not_found\",\n            \"message\": \"\uacb0\uc81c \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4\",\n            \"retry_possible\": False\n        }\n\n    except RateLimitError as e:\n        # \uc694\uccad \ud55c\ub3c4 \ucd08\uacfc - \uc7ac\uc2dc\ub3c4 \uc548\ub0b4\n        return {\n            \"success\": False,\n            \"error_type\": \"rate_limit\",\n            \"message\": \"\uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694\",\n            \"retry_possible\": True,\n            \"retry_after\": 60\n        }\n\n    except NetworkError as e:\n        # \ub124\ud2b8\uc6cc\ud06c \uc624\ub958 - \uc7ac\uc2dc\ub3c4 \uac00\ub2a5\n        logger.warning(f\"\ub124\ud2b8\uc6cc\ud06c \uc624\ub958: {e}\")\n        return {\n            \"success\": False,\n            \"error_type\": \"network_error\",\n            \"message\": \"\uc77c\uc2dc\uc801\uc778 \ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4\",\n            \"retry_possible\": True\n        }\n\n    except APIError as e:\n        # \uae30\ud0c0 API \uc624\ub958\n        logger.error(f\"API \uc624\ub958 [{e.error_code}]: {e.message}\")\n        return {\n            \"success\": False,\n            \"error_type\": \"api_error\",\n            \"error_code\": e.error_code,\n            \"message\": e.message,\n            \"retry_possible\": should_retry(e.error_code)\n        }\n\ndef should_retry(error_code):\n    \"\"\"\uc5d0\ub7ec \ucf54\ub4dc\uc5d0 \ub530\ub978 \uc7ac\uc2dc\ub3c4 \uac00\ub2a5 \uc5ec\ubd80 \ud310\ub2e8\"\"\"\n    non_retryable_codes = {\n        \"INVALID_PAYMENT_KEY\",\n        \"ALREADY_CANCELED_PAYMENT\", \n        \"INVALID_ORDER_ID\"\n    }\n    return error_code not in non_retryable_codes\n</code></pre>"},{"location":"api/error-handling/#3","title":"3. \uc7ac\uc2dc\ub3c4 \ub85c\uc9c1","text":"<pre><code>import time\nfrom functools import wraps\n\ndef retry_on_error(max_retries=3, delay=1, backoff=2):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            last_exception = None\n\n            for attempt in range(max_retries):\n                try:\n                    return func(*args, **kwargs)\n\n                except (NetworkError, RateLimitError) as e:\n                    last_exception = e\n                    if attempt &lt; max_retries - 1:\n                        wait_time = delay * (backoff ** attempt)\n                        logger.info(f\"\uc7ac\uc2dc\ub3c4 {attempt + 1}/{max_retries} ({wait_time}\ucd08 \ud6c4)\")\n                        time.sleep(wait_time)\n                    else:\n                        logger.error(f\"\ucd5c\ub300 \uc7ac\uc2dc\ub3c4 \ud69f\uc218 \ucd08\uacfc: {e}\")\n\n                except (ValidationError, AuthenticationError, PaymentNotFoundError):\n                    # \uc7ac\uc2dc\ub3c4\ud574\ub3c4 \ud574\uacb0\ub418\uc9c0 \uc54a\ub294 \uc624\ub958\ub4e4\n                    raise\n\n            raise last_exception\n\n        return wrapper\n    return decorator\n\n@retry_on_error(max_retries=3, delay=2)\ndef robust_payment_retrieve(payment_key):\n    return client.payments.retrieve(payment_key)\n</code></pre>"},{"location":"api/error-handling/#_6","title":"\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc5d0\ub7ec \ucf54\ub4dc","text":""},{"location":"api/error-handling/#_7","title":"\uc8fc\uc694 \uc5d0\ub7ec \ucf54\ub4dc\uc640 \ub300\uc751 \ubc29\ubc95","text":"<pre><code>def handle_toss_error_code(error_code, error_message):\n    \"\"\"\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc5d0\ub7ec \ucf54\ub4dc\ubcc4 \ucc98\ub9ac\"\"\"\n\n    error_handlers = {\n        # \uc778\uc99d \uad00\ub828\n        \"INVALID_API_KEY\": lambda: handle_auth_error(\"API \ud0a4\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4\"),\n        \"UNAUTHORIZED_KEY\": lambda: handle_auth_error(\"API \ud0a4 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4\"),\n\n        # \uacb0\uc81c \uad00\ub828\n        \"INVALID_PAYMENT_KEY\": lambda: handle_payment_error(\"\uacb0\uc81c \ud0a4\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4\"),\n        \"ALREADY_CANCELED_PAYMENT\": lambda: handle_payment_error(\"\uc774\ubbf8 \ucde8\uc18c\ub41c \uacb0\uc81c\uc785\ub2c8\ub2e4\"),\n        \"CANCEL_AMOUNT_EXCEEDED\": lambda: handle_payment_error(\"\ucde8\uc18c \uac00\ub2a5 \uae08\uc561\uc744 \ucd08\uacfc\ud588\uc2b5\ub2c8\ub2e4\"),\n\n        # \uc8fc\ubb38 \uad00\ub828\n        \"INVALID_ORDER_ID\": lambda: handle_order_error(\"\uc8fc\ubb38 ID\uac00 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4\"),\n        \"DUPLICATED_ORDER_ID\": lambda: handle_order_error(\"\uc911\ubcf5\ub41c \uc8fc\ubb38 ID\uc785\ub2c8\ub2e4\"),\n\n        # \uae08\uc561 \uad00\ub828\n        \"INVALID_AMOUNT\": lambda: handle_amount_error(\"\uacb0\uc81c \uae08\uc561\uc774 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4\"),\n        \"AMOUNT_NOT_MATCHED\": lambda: handle_amount_error(\"\uacb0\uc81c \uae08\uc561\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4\"),\n    }\n\n    handler = error_handlers.get(error_code)\n    if handler:\n        return handler()\n    else:\n        return handle_unknown_error(error_code, error_message)\n\ndef handle_auth_error(message):\n    logger.critical(f\"\uc778\uc99d \uc624\ub958: {message}\")\n    send_admin_alert(f\"API \ud0a4 \ud655\uc778 \ud544\uc694: {message}\")\n    return {\"error_type\": \"auth\", \"message\": \"\uc2dc\uc2a4\ud15c \uc624\ub958\uc785\ub2c8\ub2e4\", \"retry\": False}\n\ndef handle_payment_error(message):\n    logger.warning(f\"\uacb0\uc81c \uc624\ub958: {message}\")\n    return {\"error_type\": \"payment\", \"message\": message, \"retry\": False}\n\ndef handle_order_error(message):\n    logger.info(f\"\uc8fc\ubb38 \uc624\ub958: {message}\")\n    return {\"error_type\": \"order\", \"message\": message, \"retry\": False}\n\ndef handle_amount_error(message):\n    logger.info(f\"\uae08\uc561 \uc624\ub958: {message}\")\n    return {\"error_type\": \"amount\", \"message\": message, \"retry\": False}\n\ndef handle_unknown_error(error_code, message):\n    logger.error(f\"\uc54c \uc218 \uc5c6\ub294 \uc5d0\ub7ec [{error_code}]: {message}\")\n    return {\"error_type\": \"unknown\", \"message\": \"\uc54c \uc218 \uc5c6\ub294 \uc624\ub958\uc785\ub2c8\ub2e4\", \"retry\": True}\n</code></pre>"},{"location":"api/error-handling/#_8","title":"\uc5d0\ub7ec \ub85c\uae45 \ubc0f \ubaa8\ub2c8\ud130\ub9c1","text":""},{"location":"api/error-handling/#_9","title":"\uad6c\uc870\ud654\ub41c \ub85c\uae45","text":"<pre><code>import logging\nimport json\nfrom datetime import datetime\n\nclass TossPaymentsErrorLogger:\n    def __init__(self):\n        self.logger = logging.getLogger(\"toss_payments\")\n\n    def log_error(self, error, context=None):\n        \"\"\"\uc5d0\ub7ec \ub85c\uae45\"\"\"\n        error_data = {\n            \"timestamp\": datetime.now().isoformat(),\n            \"error_type\": type(error).__name__,\n            \"error_message\": str(error),\n            \"context\": context or {}\n        }\n\n        if isinstance(error, APIError):\n            error_data.update({\n                \"error_code\": error.error_code,\n                \"status_code\": error.status_code,\n                \"response_data\": error.response_data\n            })\n\n        self.logger.error(json.dumps(error_data, ensure_ascii=False))\n\n    def log_retry(self, attempt, max_retries, error):\n        \"\"\"\uc7ac\uc2dc\ub3c4 \ub85c\uae45\"\"\"\n        retry_data = {\n            \"timestamp\": datetime.now().isoformat(),\n            \"event\": \"retry_attempt\",\n            \"attempt\": attempt,\n            \"max_retries\": max_retries,\n            \"error\": str(error)\n        }\n\n        self.logger.warning(json.dumps(retry_data, ensure_ascii=False))\n\n# \uc804\uc5ed \uc5d0\ub7ec \ub85c\uac70\nerror_logger = TossPaymentsErrorLogger()\n\ndef process_payment_with_logging(payment_key, order_id, amount):\n    context = {\n        \"payment_key\": payment_key,\n        \"order_id\": order_id,\n        \"amount\": amount\n    }\n\n    try:\n        payment = client.payments.confirm(\n            payment_key=payment_key,\n            order_id=order_id,\n            amount=amount\n        )\n        return {\"success\": True, \"payment\": payment}\n\n    except TossPaymentsError as e:\n        error_logger.log_error(e, context)\n        return {\"success\": False, \"error\": str(e)}\n</code></pre>"},{"location":"api/error-handling/#_10","title":"\uc5d0\ub7ec \uba54\ud2b8\ub9ad \uc218\uc9d1","text":"<pre><code>from collections import defaultdict, Counter\nfrom datetime import datetime, timedelta\n\nclass ErrorMetrics:\n    def __init__(self):\n        self.error_counts = defaultdict(int)\n        self.error_times = defaultdict(list)\n\n    def record_error(self, error_type, error_code=None):\n        \"\"\"\uc5d0\ub7ec \ubc1c\uc0dd \uae30\ub85d\"\"\"\n        key = f\"{error_type}:{error_code}\" if error_code else error_type\n        self.error_counts[key] += 1\n        self.error_times[key].append(datetime.now())\n\n    def get_error_rate(self, error_type, time_window_minutes=60):\n        \"\"\"\uc2dc\uac04\ub300\ubcc4 \uc5d0\ub7ec\uc728 \uacc4\uc0b0\"\"\"\n        cutoff_time = datetime.now() - timedelta(minutes=time_window_minutes)\n        recent_errors = [\n            t for t in self.error_times[error_type] \n            if t &gt; cutoff_time\n        ]\n        return len(recent_errors)\n\n    def get_top_errors(self, limit=10):\n        \"\"\"\uac00\uc7a5 \ube48\ubc88\ud55c \uc5d0\ub7ec \ubaa9\ub85d\"\"\"\n        return Counter(self.error_counts).most_common(limit)\n\n# \uc804\uc5ed \uba54\ud2b8\ub9ad \uc218\uc9d1\uae30\nmetrics = ErrorMetrics()\n\ndef monitored_api_call(func, *args, **kwargs):\n    \"\"\"API \ud638\ucd9c \ubaa8\ub2c8\ud130\ub9c1 \ub370\ucf54\ub808\uc774\ud130\"\"\"\n    try:\n        return func(*args, **kwargs)\n\n    except APIError as e:\n        metrics.record_error(\"api_error\", e.error_code)\n\n        # \uc5d0\ub7ec\uc728\uc774 \ub192\uc73c\uba74 \uc54c\ub9bc\n        if metrics.get_error_rate(\"api_error\") &gt; 10:  # 1\uc2dc\uac04\uc5d0 10\ud68c \uc774\uc0c1\n            send_alert(\"API \uc5d0\ub7ec\uc728 \uae09\uc99d\")\n\n        raise\n    except Exception as e:\n        metrics.record_error(type(e).__name__)\n        raise\n</code></pre>"},{"location":"api/error-handling/#_11","title":"\uc6f9 \ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \uc5d0\ub7ec \ucc98\ub9ac","text":""},{"location":"api/error-handling/#flask","title":"Flask","text":"<p>```python from flask import Flask, jsonify, request from tosspayments_server_sdk.exceptions import TossPaymentsError, APIError</p> <p>app = Flask(name)</p> <p>@app.errorhandler(TossPaymentsError) def handle_toss_error(error):     \"\"\"TossPayments \uc5d0\ub7ec \ud578\ub4e4\ub7ec\"\"\"     response = {         \"success\": False,         \"error_type\": type(error).name,         \"message\": str(error)     }</p> <pre><code>if isinstance(error, APIError):\n    response.update({\n        \"error_code\": error.error_code,\n        \"status_code\": error.status_code\n    })\n\nreturn jsonify(response), 400\n</code></pre> <p>@app.route('/payment/confirm', methods=['POST']) def confirm_payment():     try:         data = request.get_json()         payment = client.payments.confirm(             payment_key=data['paymentKey'],             order_id=data['orderId'],             amount=data['amount']         )         return jsonify({\"success\": True, \"payment\": payment.to_dict()</p>"},{"location":"api/payments/","title":"\uacb0\uc81c API","text":"<p>\uacb0\uc81c \uc2b9\uc778, \uc870\ud68c, \ucde8\uc18c \ub4f1 \uacb0\uc81c\uc640 \uad00\ub828\ub41c \ubaa8\ub4e0 \uae30\ub2a5\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4.</p>"},{"location":"api/payments/#_1","title":"\ud074\ub77c\uc774\uc5b8\ud2b8 \uc811\uadfc","text":"<pre><code>from tosspayments_server_sdk import Client\n\nclient = Client(secret_key=\"your_secret_key\")\n\n# payments \ub9ac\uc18c\uc2a4\uc5d0 \uc811\uadfc\npayments = client.payments\n</code></pre>"},{"location":"api/payments/#_2","title":"\uacb0\uc81c \uc2b9\uc778","text":"<p>\uacb0\uc81c\ucc3d\uc5d0\uc11c \ubc1b\uc740 \uc815\ubcf4\ub85c \uc2e4\uc81c \uacb0\uc81c\ub97c \uc2b9\uc778\ud569\ub2c8\ub2e4.</p>"},{"location":"api/payments/#_3","title":"\uae30\ubcf8 \uc0ac\uc6a9\ubc95","text":"<pre><code>payment = client.payments.confirm(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    order_id=\"order-20240101-001\",\n    amount=15000\n)\n</code></pre>"},{"location":"api/payments/#_4","title":"\ub9e4\uac1c\ubcc0\uc218","text":"\uc774\ub984 \ud0c0\uc785 \ud544\uc218 \uc124\uba85 <code>payment_key</code> str \u2705 \uacb0\uc81c\ud0a4 (\uacb0\uc81c\ucc3d\uc5d0\uc11c \ubc1b\uc740 \uac12) <code>order_id</code> str \u2705 \uc8fc\ubb38 ID (\uac00\ub9f9\uc810\uc5d0\uc11c \uc0dd\uc131\ud55c \uace0\uc720\uac12) <code>amount</code> int \u2705 \uacb0\uc81c \uae08\uc561"},{"location":"api/payments/#_5","title":"\uc751\ub2f5","text":"<p><code>Payment</code> \uac1d\uccb4\uac00 \ubc18\ud658\ub429\ub2c8\ub2e4. \uc8fc\uc694 \ud544\ub4dc:</p> <pre><code>print(payment.status)           # PaymentStatus.DONE\nprint(payment.method)           # \"\uce74\ub4dc\" \nprint(payment.total_amount)     # 15000\nprint(payment.order_name)       # \"\uc0c1\ud488\uba85\"\nprint(payment.approved_at)      # datetime \uac1d\uccb4\n</code></pre>"},{"location":"api/payments/#_6","title":"\uc5d0\ub7ec \ucc98\ub9ac","text":"<pre><code>from tosspayments_server_sdk.exceptions import ValidationError, APIError\n\ntry:\n    payment = client.payments.confirm(\n        payment_key=payment_key,\n        order_id=order_id, \n        amount=amount\n    )\nexcept ValidationError as e:\n    print(f\"\uc785\ub825\uac12 \uc624\ub958: {e}\")\nexcept APIError as e:\n    print(f\"API \uc624\ub958 [{e.error_code}]: {e.message}\")\n</code></pre>"},{"location":"api/payments/#_7","title":"\uacb0\uc81c \uc870\ud68c","text":""},{"location":"api/payments/#paymentkey","title":"paymentKey\ub85c \uc870\ud68c","text":"<pre><code>payment = client.payments.retrieve(\"mc_1234567890123456789012345678901234567890\")\n</code></pre>"},{"location":"api/payments/#orderid","title":"orderId\ub85c \uc870\ud68c","text":"<pre><code>payment = client.payments.retrieve_by_order_id(\"order-20240101-001\")\n</code></pre>"},{"location":"api/payments/#_8","title":"\uacb0\uc81c \uc0c1\ud0dc \ud655\uc778","text":"<pre><code># \uc0c1\ud0dc \ud655\uc778 \uba54\uc11c\ub4dc\ub4e4\nif payment.is_paid():\n    print(\"\uacb0\uc81c \uc644\ub8cc\")\n\nif payment.is_canceled():\n    print(\"\uacb0\uc81c \ucde8\uc18c\ub428\")\n\nif payment.can_be_canceled():\n    print(f\"\ucde8\uc18c \uac00\ub2a5 \uae08\uc561: {payment.get_cancelable_amount()}\")\n</code></pre>"},{"location":"api/payments/#_9","title":"\uacb0\uc81c \ucde8\uc18c","text":""},{"location":"api/payments/#_10","title":"\uc804\uccb4 \ucde8\uc18c","text":"<pre><code>canceled_payment = client.payments.cancel(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    cancel_reason=\"\ub2e8\uc21c \ubcc0\uc2ec\"\n)\n</code></pre>"},{"location":"api/payments/#_11","title":"\ubd80\ubd84 \ucde8\uc18c","text":"<pre><code>canceled_payment = client.payments.cancel(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    cancel_reason=\"\ubd80\ubd84 \ud658\ubd88\", \n    cancel_amount=5000  # 5,000\uc6d0\ub9cc \ucde8\uc18c\n)\n</code></pre>"},{"location":"api/payments/#_12","title":"\uac00\uc0c1\uacc4\uc88c \ud658\ubd88 (\ud658\ubd88 \uacc4\uc88c \uc9c0\uc815)","text":"<pre><code>canceled_payment = client.payments.cancel(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    cancel_reason=\"\ud658\ubd88 \uc694\uccad\",\n    refund_receive_account={\n        \"bank\": \"88\",  # \uc2e0\ud55c\uc740\ud589\n        \"accountNumber\": \"12345678901\", \n        \"holderName\": \"\ud64d\uae38\ub3d9\"\n    }\n)\n</code></pre>"},{"location":"api/payments/#_13","title":"\ucde8\uc18c \ub9e4\uac1c\ubcc0\uc218","text":"\uc774\ub984 \ud0c0\uc785 \ud544\uc218 \uc124\uba85 <code>payment_key</code> str \u2705 \uacb0\uc81c\ud0a4 <code>cancel_reason</code> str \u2705 \ucde8\uc18c \uc0ac\uc720 <code>cancel_amount</code> int \u274c \ucde8\uc18c \uae08\uc561 (\ubbf8\uc9c0\uc815\uc2dc \uc804\uccb4 \ucde8\uc18c) <code>refund_receive_account</code> dict \u274c \ud658\ubd88 \uacc4\uc88c \uc815\ubcf4 <code>tax_free_amount</code> int \u274c \uba74\uc138 \uae08\uc561"},{"location":"api/payments/#payment","title":"Payment \uac1d\uccb4","text":""},{"location":"api/payments/#_14","title":"\uae30\ubcf8 \uc815\ubcf4","text":"<pre><code># \uacb0\uc81c \uae30\ubcf8 \uc815\ubcf4\npayment.payment_key          # \uacb0\uc81c\ud0a4\npayment.order_id            # \uc8fc\ubb38 ID  \npayment.order_name          # \uc8fc\ubb38\uba85\npayment.status              # PaymentStatus enum\npayment.method              # \uacb0\uc81c \uc218\ub2e8\npayment.total_amount        # \ucd1d \uacb0\uc81c \uae08\uc561\npayment.balance_amount      # \uc794\uc5ec \uae08\uc561 (\ucde8\uc18c \ud6c4)\npayment.requested_at        # \uacb0\uc81c \uc694\uccad \uc2dc\uac01\npayment.approved_at         # \uacb0\uc81c \uc2b9\uc778 \uc2dc\uac01\n</code></pre>"},{"location":"api/payments/#_15","title":"\uacb0\uc81c \uc218\ub2e8\ubcc4 \uc815\ubcf4","text":""},{"location":"api/payments/#_16","title":"\uce74\ub4dc \uacb0\uc81c","text":"<pre><code>if payment.card:\n    card = payment.card\n    print(f\"\uce74\ub4dc\uc0ac: {card.issuer_code}\")\n    print(f\"\uc2b9\uc778\ubc88\ud638: {card.approve_no}\")\n    print(f\"\ud560\ubd80\uac1c\uc6d4: {card.installment_plan_months}\")\n</code></pre>"},{"location":"api/payments/#_17","title":"\uac00\uc0c1\uacc4\uc88c","text":"<pre><code>if payment.virtual_account:\n    va = payment.virtual_account\n    print(f\"\uc740\ud589: {va.bank_code}\")\n    print(f\"\uacc4\uc88c\ubc88\ud638: {va.account_number}\")\n    print(f\"\uc785\uae08\uae30\ud55c: {va.due_date}\")\n    print(f\"\uc815\uc0b0\uae08\uc561: {va.settled_amount}\")\n</code></pre>"},{"location":"api/payments/#_18","title":"\ucde8\uc18c \ub0b4\uc5ed","text":"<pre><code># \ucde8\uc18c \ub0b4\uc5ed \ud655\uc778\nfor cancel in payment.cancels:\n    print(f\"\ucde8\uc18c\uae08\uc561: {cancel.cancel_amount}\")\n    print(f\"\ucde8\uc18c\uc0ac\uc720: {cancel.cancel_reason}\")\n    print(f\"\ucde8\uc18c\uc2dc\uac01: {cancel.canceled_at}\")\n</code></pre>"},{"location":"api/payments/#paymentstatus-enum","title":"PaymentStatus enum","text":"<pre><code>from tosspayments_server_sdk.models.enums import PaymentStatus\n\nPaymentStatus.READY                 # \uacb0\uc81c \uc900\ube44\nPaymentStatus.IN_PROGRESS          # \uacb0\uc81c \uc9c4\ud589 \uc911  \nPaymentStatus.WAITING_FOR_DEPOSIT  # \uc785\uae08 \ub300\uae30\nPaymentStatus.DONE                 # \uacb0\uc81c \uc644\ub8cc\nPaymentStatus.CANCELED             # \uacb0\uc81c \ucde8\uc18c\nPaymentStatus.PARTIAL_CANCELED     # \ubd80\ubd84 \ucde8\uc18c\nPaymentStatus.ABORTED              # \uacb0\uc81c \uc911\ub2e8\nPaymentStatus.EXPIRED              # \uacb0\uc81c \ub9cc\ub8cc\n</code></pre>"},{"location":"api/payments/#_19","title":"\uc2e4\uc81c \uc0ac\uc6a9 \uc608\uc81c","text":"<p>\uacb0\uc81c \ud504\ub85c\uc138\uc2a4\uc758 \uc804\uccb4 \ud750\ub984:</p> <pre><code>def process_payment(payment_key: str, order_id: str, amount: int):\n    try:\n        # 1. \uacb0\uc81c \uc2b9\uc778\n        payment = client.payments.confirm(\n            payment_key=payment_key,\n            order_id=order_id,\n            amount=amount\n        )\n\n        # 2. \uacb0\uc81c \uc131\uacf5 \ud655\uc778\n        if payment.is_paid():\n            # 3. \uc8fc\ubb38 \uc644\ub8cc \ucc98\ub9ac\n            complete_order(order_id, payment)\n            return {\"success\": True, \"payment\": payment}\n        else:\n            return {\"success\": False, \"error\": \"\uacb0\uc81c\uac00 \uc644\ub8cc\ub418\uc9c0 \uc54a\uc74c\"}\n\n    except APIError as e:\n        # 4. \uc5d0\ub7ec \ucc98\ub9ac\n        return {\"success\": False, \"error\": str(e)}\n\ndef complete_order(order_id: str, payment):\n    \"\"\"\uc8fc\ubb38 \uc644\ub8cc \ud6c4 \ucc98\ub9ac \ub85c\uc9c1\"\"\"\n    # \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5c5\ub370\uc774\ud2b8\n    # \uc7ac\uace0 \ucc28\uac10  \n    # \ubc30\uc1a1 \uc900\ube44\n    # \uace0\uac1d \uc54c\ub9bc\n    pass\n</code></pre>"},{"location":"api/webhooks/","title":"\uc6f9\ud6c5 (Webhook)","text":"<p>\ud1a0\uc2a4\ud398\uc774\uba3c\uce20\uc5d0\uc11c \uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd, \uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ub4f1\uc758 \uc774\ubca4\ud2b8\ub97c \uc2e4\uc2dc\uac04\uc73c\ub85c \uc54c\ub824\uc8fc\ub294 \uc6f9\ud6c5\uc744 \ucc98\ub9ac\ud558\ub294 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4.</p>"},{"location":"api/webhooks/#_1","title":"\uc6f9\ud6c5\uc774\ub780?","text":"<p>\uc6f9\ud6c5\uc740 \ud1a0\uc2a4\ud398\uc774\uba3c\uce20\uc5d0\uc11c \uacb0\uc81c \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub420 \ub54c \uc5ec\ub7ec\ubd84\uc758 \uc11c\ubc84\ub85c \uc2e4\uc2dc\uac04 \uc54c\ub9bc\uc744 \ubcf4\ub0b4\ub294 \uae30\ub2a5\uc785\ub2c8\ub2e4. \uc774\ub97c \ud1b5\ud574:</p> <ul> <li>\uacb0\uc81c \uc644\ub8cc/\uc2e4\ud328\ub97c \uc989\uc2dc \uac10\uc9c0</li> <li>\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ud655\uc778</li> <li>\uacb0\uc81c \ucde8\uc18c \ucc98\ub9ac</li> <li>\uc790\ub3d9\ud654\ub41c \uc8fc\ubb38 \ucc98\ub9ac</li> </ul>"},{"location":"api/webhooks/#_2","title":"\uc9c0\uc6d0\ud558\ub294 \uc6f9\ud6c5 \uc774\ubca4\ud2b8","text":""},{"location":"api/webhooks/#1-payment_status_changed","title":"1. \uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd (<code>PAYMENT_STATUS_CHANGED</code>)","text":"<p>\uacb0\uc81c \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub420 \ub54c \ubc1c\uc0dd:</p> <pre><code>{\n  \"eventType\": \"PAYMENT_STATUS_CHANGED\",\n  \"createdAt\": \"2024-01-01T12:00:00.000Z\",\n  \"data\": {\n    \"paymentKey\": \"mc_1234567890123456789012345678901234567890\",\n    \"orderId\": \"order-20240101-001\",\n    \"status\": \"DONE\",\n    ...\n  }\n}\n</code></pre>"},{"location":"api/webhooks/#2-cancel_status_changed","title":"2. \ucde8\uc18c \uc0c1\ud0dc \ubcc0\uacbd (<code>CANCEL_STATUS_CHANGED</code>)","text":"<p>\uacb0\uc81c \ucde8\uc18c\uac00 \uc644\ub8cc\ub420 \ub54c \ubc1c\uc0dd:</p> <pre><code>{\n  \"eventType\": \"CANCEL_STATUS_CHANGED\", \n  \"createdAt\": \"2024-01-01T12:00:00.000Z\",\n  \"data\": {\n    \"cancelAmount\": 5000,\n    \"cancelReason\": \"\ub2e8\uc21c \ubcc0\uc2ec\",\n    \"canceledAt\": \"2024-01-01T12:00:00.000Z\",\n    ...\n  }\n}\n</code></pre>"},{"location":"api/webhooks/#3-deposit_callback","title":"3. \uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ucf5c\ubc31 (<code>DEPOSIT_CALLBACK</code>)","text":"<p>\uac00\uc0c1\uacc4\uc88c\uc5d0 \uc785\uae08\uc774 \uc644\ub8cc\ub420 \ub54c \ubc1c\uc0dd:</p> <pre><code>{\n  \"createdAt\": \"2024-01-01T12:00:00.000Z\",\n  \"secret\": \"webhook_secret_value\",\n  \"status\": \"DONE\",\n  \"transactionKey\": \"9FF15E1A29D0E77C218F57262BFA4986\",\n  \"orderId\": \"order-20240101-001\"\n}\n</code></pre>"},{"location":"api/webhooks/#_3","title":"\uae30\ubcf8 \uc0ac\uc6a9\ubc95","text":""},{"location":"api/webhooks/#_4","title":"\uc6f9\ud6c5 \ud30c\uc2f1","text":"<pre><code>from tosspayments_server_sdk import Client\n\nclient = Client(secret_key=\"your_secret_key\")\n\n# \uc6f9\ud6c5 \ub370\uc774\ud130 \ud30c\uc2f1 (request.body \ub610\ub294 request.data)\nwebhook_event = client.webhooks.verify_and_parse(request_body)\n\n# \uc774\ubca4\ud2b8 \ud0c0\uc785 \ud655\uc778\nif webhook_event.is_payment_event:\n    print(\"\uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd \uc774\ubca4\ud2b8\")\nelif webhook_event.is_cancel_event:\n    print(\"\ucde8\uc18c \uc0c1\ud0dc \ubcc0\uacbd \uc774\ubca4\ud2b8\")\nelif webhook_event.is_virtual_account_event:\n    print(\"\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc774\ubca4\ud2b8\")\n</code></pre>"},{"location":"api/webhooks/#_5","title":"\ud504\ub808\uc784\uc6cc\ud06c\ubcc4 \uad6c\ud604","text":""},{"location":"api/webhooks/#flask","title":"Flask \uc608\uc2dc","text":"<pre><code>from flask import Flask, request, jsonify\nfrom tosspayments_server_sdk import Client\nfrom tosspayments_server_sdk.exceptions import WebhookVerificationError\n\napp = Flask(__name__)\nclient = Client(secret_key=\"your_secret_key\")\n\n@app.route('/webhook/toss', methods=['POST'])\ndef handle_toss_webhook():\n    try:\n        # \uc6f9\ud6c5 \ud30c\uc2f1\n        webhook_event = client.webhooks.verify_and_parse(request.data)\n\n        # \uc774\ubca4\ud2b8 \ud0c0\uc785\ubcc4 \ucc98\ub9ac\n        if webhook_event.is_payment_event:\n            return handle_payment_event(webhook_event)\n        elif webhook_event.is_cancel_event:\n            return handle_cancel_event(webhook_event)\n        elif webhook_event.is_virtual_account_event:\n            return handle_deposit_event(webhook_event)\n\n        return jsonify({\"status\": \"unknown_event\"}), 400\n\n    except WebhookVerificationError as e:\n        print(f\"\uc6f9\ud6c5 \uac80\uc99d \uc2e4\ud328: {e}\")\n        return jsonify({\"error\": \"invalid_webhook\"}), 400\n    except Exception as e:\n        print(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc624\ub958: {e}\")\n        return jsonify({\"error\": \"internal_error\"}), 500\n\ndef handle_payment_event(event):\n    payment = event.payment\n\n    if payment.is_paid():\n        # \uacb0\uc81c \uc644\ub8cc \ucc98\ub9ac\n        complete_order(payment.order_id, payment)\n\n    elif payment.is_canceled():\n        # \uacb0\uc81c \ucde8\uc18c \ucc98\ub9ac\n        cancel_order(payment.order_id, payment)\n\n    return jsonify({\"status\": \"success\"})\n\ndef handle_cancel_event(event):\n    cancellation = event.cancellation\n\n    # \ucde8\uc18c \uc644\ub8cc \ucc98\ub9ac\n    process_cancellation(cancellation)\n\n    return jsonify({\"status\": \"success\"})\n\ndef handle_deposit_event(event):\n    if event.is_deposit_completed():\n        # \uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc644\ub8cc \ucc98\ub9ac\n        complete_virtual_account_payment(event.order_id)\n\n    return jsonify({\"status\": \"success\"})\n</code></pre>"},{"location":"api/webhooks/#django","title":"Django \uc608\uc2dc","text":"<pre><code># views.py\nfrom django.http import JsonResponse\nfrom django.views.decorators.csrf import csrf_exempt\nfrom django.views.decorators.http import require_http_methods\nimport json\n\n@csrf_exempt\n@require_http_methods([\"POST\"])\ndef toss_webhook(request):\n    try:\n        webhook_event = client.webhooks.verify_and_parse(request.body)\n\n        if webhook_event.is_payment_event:\n            payment = webhook_event.payment\n\n            # \uc8fc\ubb38 \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8\n            from myapp.models import Order\n            order = Order.objects.get(order_id=payment.order_id)\n\n            if payment.is_paid():\n                order.status = 'paid'\n                order.payment_key = payment.payment_key\n                order.save()\n\n                # \uacb0\uc81c \uc644\ub8cc \ud6c4 \ucc98\ub9ac (\uc774\uba54\uc77c \ubc1c\uc1a1, \uc7ac\uace0 \ucc28\uac10 \ub4f1)\n                order.process_payment_completion()\n\n        return JsonResponse({\"status\": \"success\"})\n\n    except Exception as e:\n        return JsonResponse({\"error\": str(e)}, status=400)\n</code></pre>"},{"location":"api/webhooks/#fastapi","title":"FastAPI \uc608\uc2dc","text":"<pre><code>from fastapi import FastAPI, Request, HTTPException\nfrom tosspayments_server_sdk import Client\n\napp = FastAPI()\nclient = Client(secret_key=\"your_secret_key\")\n\n@app.post(\"/webhook/toss\")\nasync def toss_webhook(request: Request):\n    try:\n        body = await request.body()\n        webhook_event = client.webhooks.verify_and_parse(body)\n\n        if webhook_event.is_payment_event:\n            await process_payment_event(webhook_event)\n        elif webhook_event.is_cancel_event:\n            await process_cancel_event(webhook_event)\n        elif webhook_event.is_virtual_account_event:\n            await process_deposit_event(webhook_event)\n\n        return {\"status\": \"success\"}\n\n    except Exception as e:\n        raise HTTPException(status_code=400, detail=str(e))\n\nasync def process_payment_event(event):\n    payment = event.payment\n\n    # \ube44\ub3d9\uae30 \ucc98\ub9ac\n    if payment.is_paid():\n        await send_payment_notification(payment.order_id)\n        await update_inventory(payment.order_id)\n</code></pre>"},{"location":"api/webhooks/#_6","title":"\uc774\ubca4\ud2b8\ubcc4 \uc0c1\uc138 \ucc98\ub9ac","text":""},{"location":"api/webhooks/#_7","title":"\uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd \uc774\ubca4\ud2b8","text":"<pre><code>def handle_payment_event(event):\n    payment = event.payment\n\n    # \uae30\ubcf8 \uc815\ubcf4\n    print(f\"\uc8fc\ubb38 ID: {event.order_id}\")\n    print(f\"\uacb0\uc81c \ud0a4: {event.payment_key}\")\n    print(f\"\uc0c1\ud0dc: {event.status}\")\n\n    # \uc0c1\ud0dc\ubcc4 \ucc98\ub9ac\n    if payment.is_paid():\n        # \uacb0\uc81c \uc644\ub8cc\n        print(f\"\uacb0\uc81c \uc644\ub8cc: {payment.total_amount:,}\uc6d0\")\n        complete_payment(payment)\n\n    elif payment.status.value == \"WAITING_FOR_DEPOSIT\":\n        # \uac00\uc0c1\uacc4\uc88c \ubc1c\uae09 \uc644\ub8cc\n        print(f\"\uac00\uc0c1\uacc4\uc88c \ubc1c\uae09: {payment.virtual_account.account_number}\")\n        notify_virtual_account(payment)\n\n    elif payment.is_canceled():\n        # \uacb0\uc81c \ucde8\uc18c\n        print(f\"\uacb0\uc81c \ucde8\uc18c: {payment.get_canceled_amount():,}\uc6d0\")\n        process_cancellation(payment)\n\n    elif payment.status.value == \"EXPIRED\":\n        # \uacb0\uc81c \ub9cc\ub8cc\n        print(\"\uacb0\uc81c \ub9cc\ub8cc\")\n        expire_order(payment.order_id)\n</code></pre>"},{"location":"api/webhooks/#_8","title":"\ucde8\uc18c \uc0c1\ud0dc \ubcc0\uacbd \uc774\ubca4\ud2b8","text":"<pre><code>def handle_cancel_event(event):\n    cancellation = event.cancellation\n\n    print(f\"\ucde8\uc18c \uae08\uc561: {cancellation.cancel_amount:,}\uc6d0\")\n    print(f\"\ucde8\uc18c \uc0ac\uc720: {cancellation.cancel_reason}\")\n    print(f\"\ucde8\uc18c \uc2dc\uac01: {cancellation.canceled_at}\")\n\n    # \ucde8\uc18c \ucc98\ub9ac\n    process_refund(cancellation)\n    send_cancel_notification(cancellation)\n</code></pre>"},{"location":"api/webhooks/#_9","title":"\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc774\ubca4\ud2b8","text":"<pre><code>def handle_deposit_event(event):\n    if event.is_deposit_completed():\n        print(f\"\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc644\ub8cc: {event.order_id}\")\n\n        # \uc8fc\ubb38 \uc644\ub8cc \ucc98\ub9ac\n        complete_virtual_account_order(event.order_id)\n\n        # \uc54c\ub9bc \ubc1c\uc1a1\n        send_deposit_notification(event.order_id)\n</code></pre>"},{"location":"api/webhooks/#_10","title":"\uc6f9\ud6c5 \ubcf4\uc548","text":""},{"location":"api/webhooks/#_11","title":"\uac00\uc0c1\uacc4\uc88c \uc6f9\ud6c5 \uac80\uc99d","text":"<p>\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc6f9\ud6c5\uc758 \uacbd\uc6b0 secret \uac12\uc73c\ub85c \uac80\uc99d:</p> <pre><code>from tosspayments_server_sdk.utils import verify_payment_webhook_secret\n\ndef handle_deposit_event(event):\n    # secret \uac80\uc99d (\uacb0\uc81c \uc2b9\uc778 \uc2dc \ubc1b\uc740 secret\uacfc \ube44\uad50)\n    expected_secret = get_payment_secret(event.order_id)  # DB\uc5d0\uc11c \uc870\ud68c\n\n    webhook_data = {\n        \"secret\": event.secret,\n        \"status\": event.status.value,\n        \"transactionKey\": event.transaction_key,\n        \"orderId\": event.order_id\n    }\n\n    if verify_payment_webhook_secret(webhook_data, expected_secret):\n        # \uac80\uc99d \uc131\uacf5\n        process_deposit(event)\n    else:\n        # \uac80\uc99d \uc2e4\ud328\n        print(\"\uc6f9\ud6c5 \uac80\uc99d \uc2e4\ud328\")\n        return False\n</code></pre>"},{"location":"api/webhooks/#_12","title":"\uc6f9\ud6c5 \uc124\uc815","text":""},{"location":"api/webhooks/#_13","title":"\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uac1c\ubc1c\uc790\uc13c\ud130 \uc124\uc815","text":"<ol> <li>\uac1c\ubc1c\uc790\uc13c\ud130 &gt; \uc5f0\ub3d9 \uad00\ub9ac &gt; \uc6f9\ud6c5</li> <li>\uc6f9\ud6c5 URL \ub4f1\ub85d: <code>https://your-domain.com/webhook/toss</code></li> <li>\uc774\ubca4\ud2b8 \uc120\ud0dd:</li> <li>\uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd</li> <li>\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ud1b5\ubcf4</li> </ol>"},{"location":"api/webhooks/#_14","title":"\uc6f9\ud6c5 \uc5d4\ub4dc\ud3ec\uc778\ud2b8 \uc694\uad6c\uc0ac\ud56d","text":"<ul> <li>HTTP \uba54\uc11c\ub4dc: POST</li> <li>\uc751\ub2f5 \uc0c1\ud0dc: 200 OK</li> <li>\ud0c0\uc784\uc544\uc6c3: 5\ucd08 \uc774\ub0b4 \uc751\ub2f5</li> <li>\uc7ac\uc2dc\ub3c4: \uc2e4\ud328 \uc2dc \ucd5c\ub300 5\ud68c \uc7ac\uc2dc\ub3c4</li> </ul>"},{"location":"api/webhooks/#_15","title":"\uc5d0\ub7ec \ucc98\ub9ac","text":""},{"location":"api/webhooks/#_16","title":"\uba71\ub4f1\uc131 \ucc98\ub9ac","text":"<p>\uc6f9\ud6c5\uc740 \uc7ac\uc2dc\ub3c4\ub420 \uc218 \uc788\uc73c\ubbc0\ub85c \uba71\ub4f1\uc131\uc744 \ubcf4\uc7a5\ud574\uc57c \ud569\ub2c8\ub2e4:</p> <pre><code>def handle_payment_event(event):\n    payment = event.payment\n\n    # \uc774\ubbf8 \ucc98\ub9ac\ub41c \uc6f9\ud6c5\uc778\uc9c0 \ud655\uc778\n    if is_webhook_already_processed(payment.payment_key, event.created_at):\n        return {\"status\": \"already_processed\"}\n\n    # \uc6f9\ud6c5 \ucc98\ub9ac\n    if payment.is_paid():\n        complete_payment(payment)\n\n    # \ucc98\ub9ac \uc644\ub8cc \uae30\ub85d\n    mark_webhook_as_processed(payment.payment_key, event.created_at)\n\n    return {\"status\": \"success\"}\n\ndef is_webhook_already_processed(payment_key, created_at):\n    # DB\uc5d0\uc11c \ucc98\ub9ac \uc5ec\ubd80 \ud655\uc778\n    from myapp.models import WebhookLog\n    return WebhookLog.objects.filter(\n        payment_key=payment_key,\n        created_at=created_at\n    ).exists()\n</code></pre>"},{"location":"api/webhooks/#_17","title":"\ud2b8\ub79c\uc7ad\uc158 \ucc98\ub9ac","text":"<pre><code>from django.db import transaction\n\n@transaction.atomic\ndef handle_payment_event(event):\n    payment = event.payment\n\n    try:\n        # \uc8fc\ubb38 \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8\n        order = Order.objects.select_for_update().get(\n            order_id=payment.order_id\n        )\n\n        if payment.is_paid():\n            order.status = 'paid'\n            order.save()\n\n            # \uc7ac\uace0 \ucc28\uac10\n            reduce_inventory(order)\n\n            # \uc6f9\ud6c5 \ub85c\uadf8 \uc800\uc7a5\n            WebhookLog.objects.create(\n                payment_key=payment.payment_key,\n                event_type=\"PAYMENT_STATUS_CHANGED\",\n                processed_at=timezone.now()\n            )\n\n    except Exception as e:\n        # \ud2b8\ub79c\uc7ad\uc158 \ub864\ubc31\n        raise e\n</code></pre>"},{"location":"api/webhooks/#_18","title":"\ud14c\uc2a4\ud2b8","text":""},{"location":"api/webhooks/#_19","title":"\uc6f9\ud6c5 \ud14c\uc2a4\ud2b8 \ub3c4\uad6c","text":"<p>\ub85c\uceec \uac1c\ubc1c \uc2dc ngrok\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc678\ubd80\uc5d0\uc11c \uc811\uadfc \uac00\ub2a5\ud55c URL \uc0dd\uc131:</p> <pre><code># ngrok \uc124\uce58 \ud6c4\nngrok http 8000\n\n# \uc0dd\uc131\ub41c URL\uc744 \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc6f9\ud6c5 URL\ub85c \uc124\uc815\n# https://abc123.ngrok.io/webhook/toss\n</code></pre>"},{"location":"api/webhooks/#_20","title":"\uc6f9\ud6c5 \uc2dc\ubbac\ub808\uc774\uc158","text":"<pre><code>def test_webhook():\n    # \ud14c\uc2a4\ud2b8\uc6a9 \uc6f9\ud6c5 \ub370\uc774\ud130\n    test_data = {\n        \"eventType\": \"PAYMENT_STATUS_CHANGED\",\n        \"createdAt\": \"2024-01-01T12:00:00.000Z\",\n        \"data\": {\n            \"paymentKey\": \"test_payment_key\",\n            \"orderId\": \"test_order_123\",\n            \"status\": \"DONE\",\n            \"totalAmount\": 15000,\n            # ... \uae30\ud0c0 \ud544\ub4dc\n        }\n    }\n\n    # \uc6f9\ud6c5 \ucc98\ub9ac \ud568\uc218 \ud638\ucd9c\n    import json\n    result = handle_toss_webhook_data(json.dumps(test_data))\n    print(f\"\ud14c\uc2a4\ud2b8 \uacb0\uacfc: {result}\")\n</code></pre>"},{"location":"api/webhooks/#_21","title":"\ubaa8\ub2c8\ud130\ub9c1","text":""},{"location":"api/webhooks/#_22","title":"\uc6f9\ud6c5 \ub85c\uae45","text":"<pre><code>import logging\n\nlogger = logging.getLogger(__name__)\n\ndef handle_toss_webhook():\n    try:\n        webhook_event = client.webhooks.verify_and_parse(request.data)\n\n        logger.info(f\"\uc6f9\ud6c5 \uc218\uc2e0: {webhook_event.event_type}\")\n\n        # \ucc98\ub9ac \ub85c\uc9c1\n        process_webhook(webhook_event)\n\n        logger.info(\"\uc6f9\ud6c5 \ucc98\ub9ac \uc644\ub8cc\")\n        return {\"status\": \"success\"}\n\n    except Exception as e:\n        logger.error(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328: {e}\", exc_info=True)\n        return {\"error\": str(e)}, 500\n</code></pre>"},{"location":"api/webhooks/#_23","title":"\uc54c\ub9bc \uc124\uc815","text":"<p>\uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328 \uc2dc \uc54c\ub9bc:</p> <pre><code>def handle_webhook_error(error, webhook_data):\n    # Slack \uc54c\ub9bc\n    send_slack_alert(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328: {error}\")\n\n    # \uc774\uba54\uc77c \uc54c\ub9bc\n    send_email_alert(\"admin@company.com\", f\"\uc6f9\ud6c5 \uc624\ub958: {error}\")\n\n    # \ubaa8\ub2c8\ud130\ub9c1 \uc2dc\uc2a4\ud15c\uc5d0 \uae30\ub85d\n    monitoring.record_error(\"webhook_failure\", {\n        \"error\": str(error),\n        \"webhook_type\": webhook_data.get(\"eventType\"),\n        \"timestamp\": datetime.now()\n    })\n</code></pre>"},{"location":"api/webhooks/#_24","title":"\ubb38\uc81c \ud574\uacb0","text":""},{"location":"api/webhooks/#_25","title":"\uc77c\ubc18\uc801\uc778 \ubb38\uc81c\ub4e4","text":"<ol> <li>\uc6f9\ud6c5\uc774 \uc218\uc2e0\ub418\uc9c0 \uc54a\uc74c</li> <li>\uc6f9\ud6c5 URL\uc774 \uc62c\ubc14\ub974\uac8c \uc124\uc815\ub418\uc5c8\ub294\uc9c0 \ud655\uc778</li> <li>\ubc29\ud654\ubcbd\uc774 \uc6f9\ud6c5 \uc694\uccad\uc744 \ucc28\ub2e8\ud558\uc9c0 \uc54a\ub294\uc9c0 \ud655\uc778</li> <li> <p>HTTPS \uc0ac\uc6a9 \uc5ec\ubd80 \ud655\uc778</p> </li> <li> <p>\uc911\ubcf5 \uc6f9\ud6c5 \ucc98\ub9ac</p> </li> <li>\uba71\ub4f1\uc131 \ucc98\ub9ac \uad6c\ud604</li> <li> <p>\uc6f9\ud6c5 ID \ub610\ub294 \uc0dd\uc131 \uc2dc\uac04\uc73c\ub85c \uc911\ubcf5 \ud655\uc778</p> </li> <li> <p>\uc6f9\ud6c5 \ud30c\uc2f1 \uc2e4\ud328</p> </li> <li>\uc694\uccad \ubcf8\ubb38\uc774 \uc62c\ubc14\ub978 JSON \ud615\uc2dd\uc778\uc9c0 \ud655\uc778</li> <li>\ubb38\uc790 \uc778\ucf54\ub529 \ud655\uc778 (UTF-8)</li> </ol> <pre><code># \ub514\ubc84\uae45\uc6a9 \ub85c\uae45\n@app.route('/webhook/toss', methods=['POST'])\ndef debug_webhook():\n    # \uc6d0\ubcf8 \ub370\uc774\ud130 \ub85c\uae45\n    raw_data = request.get_data()\n    logger.info(f\"\uc6f9\ud6c5 \uc6d0\ubcf8 \ub370\uc774\ud130: {raw_data}\")\n\n    # \ud5e4\ub354 \ud655\uc778\n    logger.info(f\"\uc6f9\ud6c5 \ud5e4\ub354: {dict(request.headers)}\")\n\n    try:\n        webhook_event = client.webhooks.verify_and_parse(raw_data)\n        return {\"status\": \"success\"}\n    except Exception as e:\n        logger.error(f\"\ud30c\uc2f1 \uc2e4\ud328: {e}\")\n        return {\"error\": str(e)}, 400\n</code></pre>"},{"location":"api/webhooks/#_26","title":"\ubaa8\ubc94 \uc0ac\ub840","text":""},{"location":"api/webhooks/#1","title":"1. \uc751\ub2f5 \uc2dc\uac04 \ucd5c\uc801\ud654","text":"<p>\uc6f9\ud6c5 \ucc98\ub9ac\ub294 5\ucd08 \uc774\ub0b4\uc5d0 \uc644\ub8cc\ud574\uc57c \ud569\ub2c8\ub2e4:</p> <pre><code>from concurrent.futures import ThreadPoolExecutor\n\nexecutor = ThreadPoolExecutor(max_workers=10)\n\n@app.route('/webhook/toss', methods=['POST'])\ndef handle_webhook():\n    try:\n        webhook_event = client.webhooks.verify_and_parse(request.data)\n\n        # \uc989\uc2dc \uc751\ub2f5 \ud6c4 \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \ucc98\ub9ac\n        executor.submit(process_webhook_async, webhook_event)\n\n        return {\"status\": \"received\"}, 200\n\n    except Exception as e:\n        return {\"error\": str(e)}, 400\n\ndef process_webhook_async(webhook_event):\n    \"\"\"\ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \uc2e4\uc81c \uc6f9\ud6c5 \ucc98\ub9ac\"\"\"\n    try:\n        if webhook_event.is_payment_event:\n            handle_payment_event(webhook_event)\n    except Exception as e:\n        logger.error(f\"\ube44\ub3d9\uae30 \uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328: {e}\")\n</code></pre>"},{"location":"api/webhooks/#2","title":"2. \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uad00\ub9ac","text":"<pre><code>from contextlib import contextmanager\n\n@contextmanager\ndef get_db_connection():\n    conn = None\n    try:\n        conn = get_database_connection()\n        yield conn\n        conn.commit()\n    except Exception:\n        if conn:\n            conn.rollback()\n        raise\n    finally:\n        if conn:\n            conn.close()\n\ndef handle_payment_event(event):\n    with get_db_connection() as conn:\n        # \ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc791\uc5c5\n        update_order_status(conn, event.payment.order_id, \"paid\")\n</code></pre>"},{"location":"api/webhooks/#3","title":"3. \uc7ac\uc2dc\ub3c4 \ub85c\uc9c1","text":"<p>\uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328 \uc2dc \uc7ac\uc2dc\ub3c4:</p> <pre><code>import time\nfrom functools import wraps\n\ndef retry_on_failure(max_retries=3, delay=1):\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            last_exception = None\n\n            for attempt in range(max_retries):\n                try:\n                    return func(*args, **kwargs)\n                except Exception as e:\n                    last_exception = e\n                    if attempt &lt; max_retries - 1:\n                        time.sleep(delay * (2 ** attempt))  # \uc9c0\uc218 \ubc31\uc624\ud504\n\n            raise last_exception\n        return wrapper\n    return decorator\n\n@retry_on_failure(max_retries=3)\ndef process_webhook(webhook_event):\n    # \uc6f9\ud6c5 \ucc98\ub9ac \ub85c\uc9c1\n    pass\n</code></pre>"},{"location":"api/webhooks/#_27","title":"\uc608\uc81c: \uc644\uc804\ud55c \uc6f9\ud6c5 \ud578\ub4e4\ub7ec","text":"<pre><code>import logging\nfrom datetime import datetime\nfrom flask import Flask, request, jsonify\nfrom tosspayments_server_sdk import Client\nfrom tosspayments_server_sdk.exceptions import WebhookVerificationError\n\napp = Flask(__name__)\nlogger = logging.getLogger(__name__)\n\n# \ud074\ub77c\uc774\uc5b8\ud2b8 \ucd08\uae30\ud654\nclient = Client(secret_key=os.getenv(\"TOSS_SECRET_KEY\"))\n\nclass WebhookHandler:\n    def __init__(self):\n        self.processed_webhooks = set()  # \uac04\ub2e8\ud55c \uc911\ubcf5 \ubc29\uc9c0\n\n    def is_duplicate(self, webhook_event):\n        \"\"\"\uc911\ubcf5 \uc6f9\ud6c5 \ud655\uc778\"\"\"\n        webhook_id = f\"{webhook_event.event_type}_{webhook_event.created_at}\"\n        if webhook_id in self.processed_webhooks:\n            return True\n        self.processed_webhooks.add(webhook_id)\n        return False\n\n    def handle_payment_status_changed(self, event):\n        \"\"\"\uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd \ucc98\ub9ac\"\"\"\n        payment = event.payment\n\n        logger.info(f\"\uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd: {payment.order_id} -&gt; {payment.status.value}\")\n\n        if payment.is_paid():\n            self.complete_payment(payment)\n        elif payment.is_canceled():\n            self.process_cancellation(payment)\n        elif payment.status.value == \"WAITING_FOR_DEPOSIT\":\n            self.notify_virtual_account(payment)\n\n    def handle_cancel_status_changed(self, event):\n        \"\"\"\ucde8\uc18c \uc0c1\ud0dc \ubcc0\uacbd \ucc98\ub9ac\"\"\"\n        cancellation = event.cancellation\n\n        logger.info(f\"\ucde8\uc18c \ucc98\ub9ac: {cancellation.cancel_amount}\uc6d0\")\n\n        self.process_refund(cancellation)\n\n    def handle_deposit_callback(self, event):\n        \"\"\"\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \ucc98\ub9ac\"\"\"\n        if event.is_deposit_completed():\n            logger.info(f\"\uac00\uc0c1\uacc4\uc88c \uc785\uae08 \uc644\ub8cc: {event.order_id}\")\n            self.complete_virtual_account_payment(event.order_id)\n\n    def complete_payment(self, payment):\n        \"\"\"\uacb0\uc81c \uc644\ub8cc \ucc98\ub9ac\"\"\"\n        # \uc8fc\ubb38 \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8\n        # \uc7ac\uace0 \ucc28\uac10\n        # \ubc30\uc1a1 \uc900\ube44\n        # \uace0\uac1d \uc54c\ub9bc\n        pass\n\n    def process_cancellation(self, payment):\n        \"\"\"\uacb0\uc81c \ucde8\uc18c \ucc98\ub9ac\"\"\"\n        # \uc8fc\ubb38 \ucde8\uc18c\n        # \uc7ac\uace0 \ubcf5\uad6c\n        # \uace0\uac1d \uc54c\ub9bc\n        pass\n\n    def notify_virtual_account(self, payment):\n        \"\"\"\uac00\uc0c1\uacc4\uc88c \uc548\ub0b4\"\"\"\n        # \uac00\uc0c1\uacc4\uc88c \uc815\ubcf4 \uace0\uac1d\uc5d0\uac8c \uc804\uc1a1\n        pass\n\n    def process_refund(self, cancellation):\n        \"\"\"\ud658\ubd88 \ucc98\ub9ac\"\"\"\n        # \ud658\ubd88 \ucc98\ub9ac \ub85c\uc9c1\n        pass\n\n    def complete_virtual_account_payment(self, order_id):\n        \"\"\"\uac00\uc0c1\uacc4\uc88c \uacb0\uc81c \uc644\ub8cc\"\"\"\n        # \uc785\uae08 \ud655\uc778 \ud6c4 \uc8fc\ubb38 \uc644\ub8cc \ucc98\ub9ac\n        pass\n\n# \uc6f9\ud6c5 \ud578\ub4e4\ub7ec \uc778\uc2a4\ud134\uc2a4\nwebhook_handler = WebhookHandler()\n\n@app.route('/webhook/toss', methods=['POST'])\ndef toss_webhook():\n    start_time = datetime.now()\n\n    try:\n        # \uc6f9\ud6c5 \ud30c\uc2f1\n        webhook_event = client.webhooks.verify_and_parse(request.data)\n\n        # \uc911\ubcf5 \ud655\uc778\n        if webhook_handler.is_duplicate(webhook_event):\n            logger.info(\"\uc911\ubcf5 \uc6f9\ud6c5 \ubb34\uc2dc\")\n            return jsonify({\"status\": \"duplicate\"}), 200\n\n        # \uc774\ubca4\ud2b8 \ud0c0\uc785\ubcc4 \ucc98\ub9ac\n        if webhook_event.is_payment_event:\n            webhook_handler.handle_payment_status_changed(webhook_event)\n        elif webhook_event.is_cancel_event:\n            webhook_handler.handle_cancel_status_changed(webhook_event)\n        elif webhook_event.is_virtual_account_event:\n            webhook_handler.handle_deposit_callback(webhook_event)\n        else:\n            logger.warning(f\"\uc54c \uc218 \uc5c6\ub294 \uc6f9\ud6c5 \ud0c0\uc785: {webhook_event.event_type}\")\n            return jsonify({\"error\": \"unknown_event_type\"}), 400\n\n        # \ucc98\ub9ac \uc2dc\uac04 \ub85c\uae45\n        process_time = (datetime.now() - start_time).total_seconds()\n        logger.info(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc644\ub8cc ({process_time:.2f}\ucd08)\")\n\n        return jsonify({\"status\": \"success\"}), 200\n\n    except WebhookVerificationError as e:\n        logger.error(f\"\uc6f9\ud6c5 \uac80\uc99d \uc2e4\ud328: {e}\")\n        return jsonify({\"error\": \"verification_failed\"}), 400\n    except Exception as e:\n        logger.error(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc624\ub958: {e}\", exc_info=True)\n\n        # \uc5d0\ub7ec \uc54c\ub9bc\n        send_error_notification(str(e), request.data)\n\n        return jsonify({\"error\": \"internal_error\"}), 500\n\ndef send_error_notification(error_message, webhook_data):\n    \"\"\"\uc5d0\ub7ec \ubc1c\uc0dd \uc2dc \uc54c\ub9bc\"\"\"\n    # Slack, \uc774\uba54\uc77c \ub4f1\uc73c\ub85c \uc54c\ub9bc \ubc1c\uc1a1\n    pass\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8000)\n</code></pre>"},{"location":"api/webhooks/#_28","title":"\ub2e4\uc74c \ub2e8\uacc4","text":"<p>\uc6f9\ud6c5 \uad6c\ud604\uc774 \uc644\ub8cc\ub418\uc5c8\ub2e4\uba74:</p> <ol> <li>\uc5d0\ub7ec \ucc98\ub9ac\uc5d0\uc11c \uc608\uc678 \uc0c1\ud669 \ub300\uc751 \ubc29\ubc95 \ud655\uc778</li> <li>\uc608\uc81c\uc5d0\uc11c \ub354 \uc790\uc138\ud55c \uad6c\ud604 \uc0ac\ub840 \ucc38\uace0</li> <li>\uc2e4\uc81c \ud658\uacbd\uc5d0\uc11c \uc6f9\ud6c5 \ud14c\uc2a4\ud2b8 \uc9c4\ud589</li> </ol>"},{"location":"getting-started/configuration/","title":"\uc124\uc815","text":"<p>TossPayments SDK \uc0ac\uc6a9\uc744 \uc704\ud55c \uc124\uc815 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4.</p>"},{"location":"getting-started/configuration/#api","title":"API \ud0a4 \ubc1c\uae09","text":""},{"location":"getting-started/configuration/#1","title":"1. \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uac1c\ubc1c\uc790\uc13c\ud130 \uac00\uc785","text":"<p>\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uac1c\ubc1c\uc790\uc13c\ud130\uc5d0\uc11c \ud68c\uc6d0\uac00\uc785 \ud6c4 \uc0c1\uc810\uc744 \ub4f1\ub85d\ud558\uc138\uc694.</p>"},{"location":"getting-started/configuration/#2-api","title":"2. API \ud0a4 \ud655\uc778","text":"<p>\uac1c\ubc1c\uc790\uc13c\ud130 &gt; \uc5f0\ub3d9 \uad00\ub9ac &gt; API \ud0a4\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:</p> <ul> <li>\ud14c\uc2a4\ud2b8 \uc2dc\ud06c\ub9bf \ud0a4: <code>test_sk_...</code>\ub85c \uc2dc\uc791</li> <li>\ub77c\uc774\ube0c \uc2dc\ud06c\ub9bf \ud0a4: <code>live_sk_...</code>\ub85c \uc2dc\uc791</li> </ul> <p>\ubcf4\uc548 \uc8fc\uc758\uc0ac\ud56d</p> <ul> <li>\uc2dc\ud06c\ub9bf \ud0a4\ub294 \uc808\ub300 \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0ac\uc774\ub4dc\uc5d0 \ub178\ucd9c\ud558\uc9c0 \ub9c8\uc138\uc694</li> <li>GitHub \ub4f1 \uacf5\uac1c \uc800\uc7a5\uc18c\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uc9c0 \ub9c8\uc138\uc694</li> <li>\ud658\uacbd\ubcc0\uc218 \ub610\ub294 \ubcf4\uc548 \uc800\uc7a5\uc18c\uc5d0\uc11c \uad00\ub9ac\ud558\uc138\uc694</li> </ul>"},{"location":"getting-started/configuration/#_2","title":"\uae30\ubcf8 \ud074\ub77c\uc774\uc5b8\ud2b8 \uc124\uc815","text":""},{"location":"getting-started/configuration/#_3","title":"\ud658\uacbd\ubcc0\uc218 \uc0ac\uc6a9 (\uad8c\uc7a5)","text":"<pre><code># .env \ud30c\uc77c \ub610\ub294 \uc2dc\uc2a4\ud15c \ud658\uacbd\ubcc0\uc218\nexport TOSS_SECRET_KEY=\"test_sk_your_secret_key_here\"\n</code></pre> <pre><code>import os\nfrom tosspayments_server_sdk import Client\n\n# \ud658\uacbd\ubcc0\uc218\uc5d0\uc11c \ud0a4 \uac00\uc838\uc624\uae30\nsecret_key = os.getenv(\"TOSS_SECRET_KEY\")\nclient = Client(secret_key=secret_key)\n</code></pre>"},{"location":"getting-started/configuration/#_4","title":"\uc9c1\uc811 \uc124\uc815","text":"<pre><code>from tosspayments_server_sdk import Client\n\n# \ud14c\uc2a4\ud2b8 \ud658\uacbd\nclient = Client(secret_key=\"test_sk_your_test_key\")\n\n# \uc6b4\uc601 \ud658\uacbd  \nclient = Client(secret_key=\"live_sk_your_live_key\")\n</code></pre>"},{"location":"getting-started/configuration/#_5","title":"\uace0\uae09 \uc124\uc815 \uc635\uc158","text":""},{"location":"getting-started/configuration/#_6","title":"\ud0c0\uc784\uc544\uc6c3 \uc124\uc815","text":"<pre><code>client = Client(\n    secret_key=\"test_sk_your_key\",\n    timeout=60  # 60\ucd08 (\uae30\ubcf8\uac12: 30\ucd08)\n)\n</code></pre>"},{"location":"getting-started/configuration/#_7","title":"\uc7ac\uc2dc\ub3c4 \uc124\uc815","text":"<pre><code>client = Client(\n    secret_key=\"test_sk_your_key\",\n    max_retries=5  # \ucd5c\ub300 5\ud68c \uc7ac\uc2dc\ub3c4 (\uae30\ubcf8\uac12: 3\ud68c)\n)\n</code></pre>"},{"location":"getting-started/configuration/#api_1","title":"API \ubc84\uc804 \uc9c0\uc815","text":"<pre><code>client = Client(\n    secret_key=\"test_sk_your_key\",\n    api_version=\"v1\"  # API \ubc84\uc804 (\uae30\ubcf8\uac12: \"v1\")\n)\n</code></pre>"},{"location":"getting-started/configuration/#_8","title":"\uc804\uccb4 \uc124\uc815 \uc608\uc2dc","text":"<pre><code>client = Client(\n    secret_key=os.getenv(\"TOSS_SECRET_KEY\"),\n    api_version=\"v1\",\n    timeout=45,\n    max_retries=3\n)\n</code></pre>"},{"location":"getting-started/configuration/#_9","title":"\ud658\uacbd\ubcc4 \uc124\uc815 \uad00\ub9ac","text":""},{"location":"getting-started/configuration/#_10","title":"\uac1c\ubc1c/\ud14c\uc2a4\ud2b8/\uc6b4\uc601 \ud658\uacbd \ubd84\ub9ac","text":"<pre><code>import os\n\nclass Config:\n    def __init__(self):\n        self.environment = os.getenv(\"ENVIRONMENT\", \"development\")\n\n        if self.environment == \"production\":\n            self.toss_secret_key = os.getenv(\"TOSS_LIVE_SECRET_KEY\")\n        else:\n            self.toss_secret_key = os.getenv(\"TOSS_TEST_SECRET_KEY\")\n\n    @property\n    def is_production(self):\n        return self.environment == \"production\"\n\n# \uc0ac\uc6a9\ubc95\nconfig = Config()\nclient = Client(secret_key=config.toss_secret_key)\n\nif config.is_production:\n    print(\"\ud83d\udd34 \uc6b4\uc601 \ud658\uacbd\uc5d0\uc11c \uc2e4\ud589 \uc911\")\nelse:\n    print(\"\ud83d\udfe1 \ud14c\uc2a4\ud2b8 \ud658\uacbd\uc5d0\uc11c \uc2e4\ud589 \uc911\")\n</code></pre>"},{"location":"getting-started/configuration/#django","title":"Django \uc124\uc815 \uc608\uc2dc","text":"<pre><code># settings.py\nimport os\n\nTOSS_SECRET_KEY = os.getenv(\"TOSS_SECRET_KEY\")\nTOSS_TIMEOUT = int(os.getenv(\"TOSS_TIMEOUT\", \"30\"))\n\n# views.py\nfrom django.conf import settings\nfrom tosspayments_server_sdk import Client\n\nclient = Client(\n    secret_key=settings.TOSS_SECRET_KEY,\n    timeout=settings.TOSS_TIMEOUT\n)\n</code></pre>"},{"location":"getting-started/configuration/#flask","title":"Flask \uc124\uc815 \uc608\uc2dc","text":"<pre><code># config.py\nimport os\n\nclass Config:\n    TOSS_SECRET_KEY = os.getenv(\"TOSS_SECRET_KEY\")\n    TOSS_TIMEOUT = int(os.getenv(\"TOSS_TIMEOUT\", \"30\"))\n\n# app.py\nfrom flask import Flask\nfrom tosspayments_server_sdk import Client\n\napp = Flask(__name__)\napp.config.from_object(\"config.Config\")\n\nclient = Client(\n    secret_key=app.config[\"TOSS_SECRET_KEY\"],\n    timeout=app.config[\"TOSS_TIMEOUT\"]\n)\n</code></pre>"},{"location":"getting-started/configuration/#_11","title":"\ubaa8\ub4dc \ud655\uc778","text":"<p>\ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uc5b4\ub5a4 \ubaa8\ub4dc\ub85c \uc2e4\ud589 \uc911\uc778\uc9c0 \ud655\uc778:</p> <pre><code>client = Client(secret_key=\"test_sk_your_key\")\n\n# \ubaa8\ub4dc \ud655\uc778\nif client.is_test_mode:\n    print(\"\ud14c\uc2a4\ud2b8 \ubaa8\ub4dc\")\nelif client.is_live_mode:\n    print(\"\uc6b4\uc601 \ubaa8\ub4dc\")\n\n# \uc548\uc804\ud55c \uacb0\uc81c \ucc98\ub9ac\ndef process_payment(payment_key, order_id, amount):\n    if client.is_test_mode:\n        print(\"\u26a0\ufe0f \ud14c\uc2a4\ud2b8 \uacb0\uc81c \uc9c4\ud589\")\n\n    return client.payments.confirm(\n        payment_key=payment_key,\n        order_id=order_id,\n        amount=amount\n    )\n</code></pre>"},{"location":"getting-started/configuration/#_12","title":"\uc124\uc815 \uac80\uc99d","text":"<p>\ud074\ub77c\uc774\uc5b8\ud2b8 \uc124\uc815\uc774 \uc62c\ubc14\ub978\uc9c0 \ud655\uc778:</p> <pre><code>from tosspayments_server_sdk.exceptions import ValidationError\n\ntry:\n    client = Client(secret_key=\"invalid_key\")\nexcept ValidationError as e:\n    print(f\"\uc124\uc815 \uc624\ub958: {e}\")\n</code></pre>"},{"location":"getting-started/configuration/#_13","title":"\ubcf4\uc548 \ubaa8\ubc94 \uc0ac\ub840","text":""},{"location":"getting-started/configuration/#1_1","title":"1. \ud658\uacbd\ubcc0\uc218 \uc0ac\uc6a9","text":"<pre><code># .env \ud30c\uc77c (\uc808\ub300 Git\uc5d0 \ucee4\ubc0b\ud558\uc9c0 \ub9c8\uc138\uc694)\nTOSS_SECRET_KEY=test_sk_your_secret_key_here\n</code></pre> <pre><code># python-dotenv \uc0ac\uc6a9\nfrom dotenv import load_dotenv\nload_dotenv()\n\nclient = Client(secret_key=os.getenv(\"TOSS_SECRET_KEY\"))\n</code></pre>"},{"location":"getting-started/configuration/#2-aws-systems-manager-parameter-store","title":"2. AWS Systems Manager Parameter Store","text":"<pre><code>import boto3\n\ndef get_secret_key():\n    ssm = boto3.client('ssm')\n    response = ssm.get_parameter(\n        Name='/myapp/toss/secret_key',\n        WithDecryption=True\n    )\n    return response['Parameter']['Value']\n\nclient = Client(secret_key=get_secret_key())\n</code></pre>"},{"location":"getting-started/configuration/#3-docker-secrets","title":"3. Docker Secrets","text":"<pre><code># docker-compose.yml\nservices:\n  app:\n    image: myapp\n    secrets:\n      - toss_secret_key\n\nsecrets:\n  toss_secret_key:\n    external: true\n</code></pre>"},{"location":"getting-started/configuration/#_14","title":"\ubb38\uc81c \ud574\uacb0","text":""},{"location":"getting-started/configuration/#_15","title":"\uc77c\ubc18\uc801\uc778 \uc124\uc815 \uc624\ub958","text":"<ol> <li> <p>\uc798\ubabb\ub41c API \ud0a4 \ud615\uc2dd <pre><code># \u274c \uc798\ubabb\ub41c \ud615\uc2dd\nclient = Client(secret_key=\"wrong_format_key\")\n\n# \u2705 \uc62c\ubc14\ub978 \ud615\uc2dd\nclient = Client(secret_key=\"test_sk_or_live_sk_format\")\n</code></pre></p> </li> <li> <p>\ud658\uacbd\ubcc0\uc218 \ubbf8\uc124\uc815 <pre><code>secret_key = os.getenv(\"TOSS_SECRET_KEY\")\nif not secret_key:\n    raise ValueError(\"TOSS_SECRET_KEY \ud658\uacbd\ubcc0\uc218\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc74c\")\n\nclient = Client(secret_key=secret_key)\n</code></pre></p> </li> <li> <p>\ub124\ud2b8\uc6cc\ud06c \ud0c0\uc784\uc544\uc6c3 <pre><code># \ud0c0\uc784\uc544\uc6c3 \ub298\ub9ac\uae30\nclient = Client(\n    secret_key=\"your_key\",\n    timeout=60  # \uae30\ubcf8 30\ucd08\uc5d0\uc11c 60\ucd08\ub85c \uc99d\uac00\n)\n</code></pre></p> </li> </ol>"},{"location":"getting-started/configuration/#_16","title":"\ub2e4\uc74c \ub2e8\uacc4","text":"<p>\uc124\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\ub2e4\uba74:</p> <ol> <li>\ube60\ub978 \uc2dc\uc791\uc5d0\uc11c \uccab \uacb0\uc81c \uc9c4\ud589\ud574\ubcf4\uae30</li> <li>\uacb0\uc81c API\uc5d0\uc11c \uc0c1\uc138 \uae30\ub2a5 \ud655\uc778</li> <li>\uc608\uc81c\uc5d0\uc11c \uc2e4\uc81c \uad6c\ud604 \ubc29\ubc95 \ucc38\uace0</li> </ol>"},{"location":"getting-started/installation/","title":"\uc124\uce58","text":"<p>TossPayments Python Server SDK\ub97c \uc124\uce58\ud558\ub294 \ubc29\ubc95\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4.</p>"},{"location":"getting-started/installation/#_2","title":"\uc694\uad6c\uc0ac\ud56d","text":"<ul> <li>Python: 3.9 \uc774\uc0c1</li> <li>\uc758\uc874\uc131: requests&gt;=2.28.0</li> </ul>"},{"location":"getting-started/installation/#pypi","title":"PyPI\ub97c \ud1b5\ud55c \uc124\uce58","text":"<p>\uac00\uc7a5 \uac04\ub2e8\ud55c \uc124\uce58 \ubc29\ubc95\uc785\ub2c8\ub2e4:</p> <pre><code>pip install tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#_3","title":"\uac00\uc0c1\ud658\uacbd \uc0ac\uc6a9 \uad8c\uc7a5","text":"<p>\ud504\ub85c\uc81d\ud2b8\ubcc4\ub85c \ub3c5\ub9bd\uc801\uc778 \ud658\uacbd\uc744 \ub9cc\ub4e4\uc5b4 \uc0ac\uc6a9\ud558\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4:</p> <pre><code># \uac00\uc0c1\ud658\uacbd \uc0dd\uc131\npython -m venv venv\n\n# \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 (Linux/Mac)\nsource venv/bin/activate\n\n# \uac00\uc0c1\ud658\uacbd \ud65c\uc131\ud654 (Windows)\nvenv\\Scripts\\activate\n\n# SDK \uc124\uce58\npip install tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#poetry","title":"Poetry\ub97c \uc0ac\uc6a9\ud55c \uc124\uce58","text":"<p>Poetry\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0:</p> <pre><code>poetry add tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#pipenv","title":"pipenv\ub97c \uc0ac\uc6a9\ud55c \uc124\uce58","text":"<p>pipenv\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0:</p> <pre><code>pipenv install tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#github","title":"GitHub\uc5d0\uc11c \uc9c1\uc811 \uc124\uce58","text":"<p>\ucd5c\uc2e0 \uac1c\ubc1c \ubc84\uc804\uc744 \uc0ac\uc6a9\ud558\uace0 \uc2f6\ub2e4\uba74:</p> <pre><code>pip install git+https://github.com/jhwang0801/tosspayments-python-server-sdk.git\n</code></pre> <p>\ud2b9\uc815 \ube0c\ub79c\uce58\ub098 \ud0dc\uadf8:</p> <pre><code># \ud2b9\uc815 \ube0c\ub79c\uce58\npip install git+https://github.com/jhwang0801/tosspayments-python-server-sdk.git@develop\n\n# \ud2b9\uc815 \ud0dc\uadf8\npip install git+https://github.com/jhwang0801/tosspayments-python-server-sdk.git@v1.0.1\n</code></pre>"},{"location":"getting-started/installation/#_4","title":"\uc124\uce58 \ud655\uc778","text":"<p>\uc124\uce58\uac00 \uc644\ub8cc\ub418\uc5c8\ub294\uc9c0 \ud655\uc778:</p> <pre><code>import tosspayments_server_sdk\nprint(tosspayments_server_sdk.__version__)\n</code></pre> <p>\ub610\ub294 \uac04\ub2e8\ud55c \ud14c\uc2a4\ud2b8:</p> <pre><code>from tosspayments_server_sdk import Client\n\n# \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0dd\uc131 (\ud14c\uc2a4\ud2b8\uc6a9 \ub354\ubbf8 \ud0a4)\nclient = Client(secret_key=\"test_sk_dummy\")\nprint(\"\u2705 SDK \uc124\uce58 \uc644\ub8cc!\")\n</code></pre>"},{"location":"getting-started/installation/#_5","title":"\uc758\uc874\uc131 \ud328\ud0a4\uc9c0","text":"<p>SDK\uac00 \uc0ac\uc6a9\ud558\ub294 \uc8fc\uc694 \uc758\uc874\uc131 \ud328\ud0a4\uc9c0\ub4e4:</p> <ul> <li>requests (&gt;= 2.28.0): HTTP \ud074\ub77c\uc774\uc5b8\ud2b8</li> </ul>"},{"location":"getting-started/installation/#_6","title":"\ubb38\uc81c \ud574\uacb0","text":""},{"location":"getting-started/installation/#ssl","title":"SSL \uc778\uc99d\uc11c \ubb38\uc81c","text":"<p>\uc77c\ubd80 \ud658\uacbd\uc5d0\uc11c SSL \uc778\uc99d\uc11c \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:</p> <pre><code>pip install --trusted-host pypi.org --trusted-host pypi.python.org --trusted-host files.pythonhosted.org tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#linuxmac","title":"\uad8c\ud55c \ubb38\uc81c (Linux/Mac)","text":"<p>\uad8c\ud55c \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud558\ub294 \uacbd\uc6b0:</p> <pre><code>pip install --user tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#python","title":"Python \ubc84\uc804 \ud638\ud658\uc131","text":"<p>Python 3.8 \uc774\ud558\uc5d0\uc11c\ub294 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4. \ubc84\uc804 \ud655\uc778:</p> <pre><code>python --version\n</code></pre>"},{"location":"getting-started/installation/#_7","title":"\uac1c\ubc1c \ud658\uacbd \uc124\uc815","text":"<p>SDK \uac1c\ubc1c\uc5d0 \uae30\uc5ec\ud558\uace0 \uc2f6\ub2e4\uba74:</p> <pre><code># \uc800\uc7a5\uc18c \ud074\ub860\ngit clone https://github.com/jhwang0801/tosspayments-python-server-sdk.git\ncd tosspayments-python-server-sdk\n\n# \uac1c\ubc1c\uc6a9 \uc124\uce58\npip install -e .\n\n# \uac1c\ubc1c \uc758\uc874\uc131 \uc124\uce58\npip install -r requirements-dev.txt\n</code></pre>"},{"location":"getting-started/installation/#_8","title":"\ubc84\uc804 \uc5c5\ub370\uc774\ud2b8","text":"<p>\uae30\uc874 \uc124\uce58\ub41c SDK\ub97c \ucd5c\uc2e0 \ubc84\uc804\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8:</p> <pre><code>pip install --upgrade tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#_9","title":"\uc81c\uac70","text":"<p>SDK\ub97c \uc81c\uac70\ud558\ub824\uba74:</p> <pre><code>pip uninstall tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/installation/#_10","title":"\ub2e4\uc74c \ub2e8\uacc4","text":"<p>\uc124\uce58\uac00 \uc644\ub8cc\ub418\uc5c8\ub2e4\uba74:</p> <ol> <li>\uc124\uc815\uc5d0\uc11c API \ud0a4 \uc124\uc815 \ubc29\ubc95 \ud655\uc778</li> <li>\ube60\ub978 \uc2dc\uc791\uc5d0\uc11c \uae30\ubcf8 \uc0ac\uc6a9\ubc95 \ud559\uc2b5</li> <li>API \uac00\uc774\ub4dc\uc5d0\uc11c \uc0c1\uc138 \uae30\ub2a5 \ud0d0\uc0c9</li> </ol>"},{"location":"getting-started/quickstart/","title":"\ube60\ub978 \uc2dc\uc791","text":"<p>\uc774 \uac00\uc774\ub4dc\ub97c \ud1b5\ud574 5\ubd84 \uc548\uc5d0 \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 Python SDK\ub97c \uc2dc\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>"},{"location":"getting-started/quickstart/#1","title":"1. \uc124\uce58","text":"<pre><code>pip install tosspayments-python-server-sdk\n</code></pre>"},{"location":"getting-started/quickstart/#2-api","title":"2. API \ud0a4 \uc900\ube44","text":"<p>\ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uac1c\ubc1c\uc790\uc13c\ud130\uc5d0\uc11c API \ud0a4\ub97c \ubc1c\uae09\ubc1b\uc73c\uc138\uc694.</p> <ul> <li>\ud14c\uc2a4\ud2b8\uc6a9: <code>test_sk_...</code>\ub85c \uc2dc\uc791</li> <li>\uc6b4\uc601\uc6a9: <code>live_sk_...</code>\ub85c \uc2dc\uc791</li> </ul> <p>\uc8fc\uc758\uc0ac\ud56d</p> <p>API \ud0a4\ub294 \uc808\ub300 \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0ac\uc774\ub4dc\uc5d0 \ub178\ucd9c\ud558\uc9c0 \ub9c8\uc138\uc694. \uc11c\ubc84 \ud658\uacbd\ubcc0\uc218\ub85c \uad00\ub9ac\ud558\ub294 \uac83\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4.</p>"},{"location":"getting-started/quickstart/#3","title":"3. \ud074\ub77c\uc774\uc5b8\ud2b8 \ucd08\uae30\ud654","text":"<pre><code>from tosspayments_server_sdk import Client\n\n# \ud658\uacbd\ubcc0\uc218\uc5d0\uc11c API \ud0a4 \uac00\uc838\uc624\uae30\nimport os\nsecret_key = os.getenv(\"TOSS_SECRET_KEY\")\n\n# \ud074\ub77c\uc774\uc5b8\ud2b8 \uc0dd\uc131\nclient = Client(secret_key=secret_key)\n\n# \ud14c\uc2a4\ud2b8/\uc6b4\uc601 \ubaa8\ub4dc \ud655\uc778\nif client.is_test_mode:\n    print(\"\ud14c\uc2a4\ud2b8 \ubaa8\ub4dc\ub85c \uc2e4\ud589 \uc911\")\n</code></pre>"},{"location":"getting-started/quickstart/#4","title":"4. \uccab \ubc88\uc9f8 \uacb0\uc81c \uc2b9\uc778","text":"<p>\uacb0\uc81c\ub294 \uc77c\ubc18\uc801\uc73c\ub85c \ub2e4\uc74c \ud750\ub984\uc73c\ub85c \uc9c4\ud589\ub429\ub2c8\ub2e4:</p> <ol> <li>\ud504\ub860\ud2b8\uc5d4\ub4dc: \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uacb0\uc81c\ucc3d\uc744 \ud1b5\ud574 \uacb0\uc81c \uc9c4\ud589</li> <li>\uacb0\uc81c\ucc3d: \uacb0\uc81c \uc644\ub8cc \ud6c4 <code>paymentKey</code>, <code>orderId</code>, <code>amount</code> \ubc18\ud658</li> <li>\ubc31\uc5d4\ub4dc: \uc774 \uc815\ubcf4\ub4e4\ub85c \uacb0\uc81c \uc2b9\uc778 API \ud638\ucd9c</li> </ol> <pre><code>try:\n    # \uacb0\uc81c \uc2b9\uc778\n    payment = client.payments.confirm(\n        payment_key=\"mc_1234567890123456789012345678901234567890\",\n        order_id=\"order-20240101-001\", \n        amount=15000\n    )\n\n    # \uacb0\uc81c \uc131\uacf5\n    if payment.is_paid():\n        print(f\"\u2705 \uacb0\uc81c \uc644\ub8cc!\")\n        print(f\"\uc8fc\ubb38\ubc88\ud638: {payment.order_id}\")\n        print(f\"\uacb0\uc81c\uae08\uc561: {payment.total_amount:,}\uc6d0\")\n        print(f\"\uacb0\uc81c\ubc29\ubc95: {payment.method}\")\n\nexcept Exception as e:\n    print(f\"\u274c \uacb0\uc81c \uc2e4\ud328: {e}\")\n</code></pre>"},{"location":"getting-started/quickstart/#5","title":"5. \uacb0\uc81c \uc815\ubcf4 \uc870\ud68c","text":"<pre><code># paymentKey\ub85c \uc870\ud68c\npayment = client.payments.retrieve(\"mc_1234567890123456789012345678901234567890\")\n\n# orderId\ub85c \uc870\ud68c  \npayment = client.payments.retrieve_by_order_id(\"order-20240101-001\")\n\nprint(f\"\uacb0\uc81c \uc0c1\ud0dc: {payment.status.value}\")\nprint(f\"\uc794\uc5ec \uae08\uc561: {payment.balance_amount:,}\uc6d0\")\n</code></pre>"},{"location":"getting-started/quickstart/#6","title":"6. \uacb0\uc81c \ucde8\uc18c","text":"<pre><code># \uc804\uccb4 \ucde8\uc18c\ncanceled_payment = client.payments.cancel(\n    payment_key=\"mc_1234567890123456789012345678901234567890\",\n    cancel_reason=\"\ub2e8\uc21c \ubcc0\uc2ec\"\n)\n\n# \ubd80\ubd84 \ucde8\uc18c (5,000\uc6d0\ub9cc)\ncanceled_payment = client.payments.cancel(\n    payment_key=\"mc_1234567890123456789012345678901234567890\", \n    cancel_reason=\"\ubd80\ubd84 \ud658\ubd88\",\n    cancel_amount=5000\n)\n\nprint(f\"\ucde8\uc18c \uc644\ub8cc: {canceled_payment.get_canceled_amount():,}\uc6d0\")\n</code></pre>"},{"location":"getting-started/quickstart/#7","title":"7. \uc6f9\ud6c5 \ucc98\ub9ac","text":"<p>\uc6f9\ud6c5\uc744 \ud1b5\ud574 \uacb0\uc81c \uc0c1\ud0dc \ubcc0\uacbd\uc744 \uc2e4\uc2dc\uac04\uc73c\ub85c \ubc1b\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4:</p> <pre><code>from flask import Flask, request\napp = Flask(__name__)\n\n@app.route('/webhook', methods=['POST'])\ndef handle_webhook():\n    try:\n        # \uc6f9\ud6c5 \ud30c\uc2f1\n        webhook_event = client.webhooks.verify_and_parse(request.data)\n\n        if webhook_event.is_payment_event:\n            payment = webhook_event.payment\n\n            if payment.is_paid():\n                # \uacb0\uc81c \uc644\ub8cc \ucc98\ub9ac\n                print(f\"\uacb0\uc81c \uc644\ub8cc: {payment.order_id}\")\n\n            elif payment.is_canceled():\n                # \uacb0\uc81c \ucde8\uc18c \ucc98\ub9ac  \n                print(f\"\uacb0\uc81c \ucde8\uc18c: {payment.order_id}\")\n\n        return \"OK\", 200\n\n    except Exception as e:\n        print(f\"\uc6f9\ud6c5 \ucc98\ub9ac \uc2e4\ud328: {e}\")\n        return \"Error\", 400\n</code></pre>"},{"location":"getting-started/quickstart/#_2","title":"\ub2e4\uc74c \ub2e8\uacc4","text":"<p>\ucd95\ud558\ud569\ub2c8\ub2e4! \ud83c\udf89 \uae30\ubcf8\uc801\uc778 \ud1a0\uc2a4\ud398\uc774\uba3c\uce20 \uc5f0\ub3d9\uc744 \uc644\ub8cc\ud588\uc2b5\ub2c8\ub2e4.</p> <p>\uc774\uc81c \ub2e4\uc74c \ub2e8\uacc4\ub85c \ub118\uc5b4\uac00\uc138\uc694:</p> <ul> <li>\uacb0\uc81c API \uc0c1\uc138 \uac00\uc774\ub4dc - \ub354 \ub9ce\uc740 \uacb0\uc81c \uae30\ub2a5</li> <li>\uc6f9\ud6c5 \uac00\uc774\ub4dc - \uc6f9\ud6c5 \ucc98\ub9ac \ubc29\ubc95  </li> <li>\uc5d0\ub7ec \ucc98\ub9ac - \uc608\uc678 \uc0c1\ud669 \ub300\uc751</li> <li>\uc2e4\uc81c \uc608\uc81c - \uc644\uc804\ud55c \uc0d8\ud50c \ucf54\ub4dc</li> </ul>"}]}